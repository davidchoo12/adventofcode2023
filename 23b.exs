input = """
#.###########################################################################################################################################
#.#...#...#...#...#...#.........#.......#...#.......#...###...###...#...#...#...###...#...#...#...#.....###...#...###...#.....#...#...#...###
#.#.#.#.#.#.#.#.#.#.#.#.#######.#.#####.#.#.#.#####.#.#.###.#.###.#.#.#.#.#.#.#.###.#.#.#.#.#.#.#.#.###.###.#.#.#.###.#.#.###.#.#.#.#.#.#.###
#.#.#.#.#.#.#.#.#.#.#...#.......#.....#.#.#.#.....#...#...#.#.#...#.#.#...#.#.#...#.#.#.#.#.#.#.#.#.#...#...#.#.#...#.#.#...#.#.#...#...#...#
#.#.#.#.#v#.#.#.#.#.#####.###########.#.#.#.#####.#######.#.#.#.###.#.#####.#.###.#.#.#.#.#.#.#.#.#.#.###.###.#.###.#.#.###.#.#.###########.#
#...#...#.>.#...#...#.....#...#...#...#...#...#...#.......#.#...#...#.#.....#...#.#.#...#.#.#.#.#...#...#...#.#.#...#.#.###.#.#.#...........#
#########v###########.#####.#.#.#.#.#########.#.###.#######.#####.###.#.#######.#.#.#####.#.#.#.#######.###.#.#.#.###.#.###.#.#.#.###########
#...#...#.#...........#...#.#.#.#.#.......#...#...#.#...###.#.....###.#.#...###.#.#.....#.#.#.#.#.......#...#...#...#.#...#.#.#.#.#...#...###
#.#.#.#.#.#.###########.#.#.#.#.#.#######.#.#####.#.#.#.###.#.#######.#.#.#.###.#.#####.#.#.#.#.#.#######.#########.#.###.#.#.#.#.#.#.#.#.###
#.#...#...#...#...###...#...#.#.#.###...#.#.#...#.#.#.#.#...#...>.>.#.#.#.#.#...#.#...#.#.#.#.#.#.#...###.....#####.#.#...#.#.#.#...#...#...#
#.###########.#.#.###.#######.#.#.###.#.#.#.#.#.#.#.#.#.#.#######v#.#.#.#.#.#.###.#.#.#.#.#.#.#.#.#.#.#######.#####.#.#.###.#.#.###########.#
#.........###.#.#...#...#.....#.#.....#.#.#...#.#.#.#.#.#...#.....#...#.#.#.#...#.#.#.#.#.#.#.#.#.#.#.>.>...#.....#...#.....#...#...#.......#
#########.###.#.###.###.#.#####.#######.#.#####.#.#.#.#.###.#.#########.#.#.###.#.#.#.#.#.#.#.#.#.#.###v###.#####.###############.#.#.#######
#####...#.#...#...#...#.#.#...#.......#.#.....#.#.#...#.#...#.#...###...#.#.#...#...#.#.#.#.#...#.#...#...#...#...###...#...###...#.#.......#
#####.#.#.#.#####.###.#.#.#.#.#######.#.#####.#.#.#####.#.###.#.#.###.###.#.#.#######.#.#.#.#####.###.###.###.#.#####.#.#.#.###.###.#######.#
#.....#...#.......###.#.#...#.#.>.>...#.......#...#...#.#...#...#...#.....#.#.#...###...#.#.#.....#...###...#...#.....#...#.....###...#.....#
#.###################.#.#####.#.#v#################.#.#.###.#######.#######.#.#.#.#######.#.#.#####.#######.#####.###################.#.#####
#...........#.........#.#.....#.#...#...###...###...#.#.#...###...#.....#...#...#.......#.#.#.#...#.#.....#.....#...#.............#...#.....#
###########.#.#########.#.#####.###.#.#.###.#.###.###.#.#.#####.#.#####.#.#############.#.#.#.#.#.#.#.###.#####.###.#.###########.#.#######.#
#...........#.....#...#.#.#...#.#...#.#.....#.....#...#.#.#...#.#.......#.>.>.....#.....#.#.#.#.#...#.#...#...#...#.#.#...........#...#.....#
#.###############.#.#.#.#.#.#.#.#.###.#############.###.#.#.#.#.###########v#####.#.#####.#.#.#.#####.#.###.#.###.#.#.#.#############.#.#####
#.........#.....#.#.#.#.#...#...#.....#.....#.....#...#...#.#...#...###...#.....#.#.....#...#...#...#.#.#...#.....#...#.............#.#.....#
#########.#.###.#.#.#.#.###############.###.#.###.###.#####.#####.#.###.#.#####.#.#####.#########.#.#.#.#.#########################.#.#####.#
#.........#.#...#...#...###.....#...###...#.#...#.....#.....#...#.#.....#.#.....#...#...#...###...#...#.#.........#...###...........#...#...#
#.#########.#.#############.###.#.#.#####.#.###.#######.#####.#.#.#######.#.#######.#.###.#.###.#######.#########.#.#.###.#############.#.###
#.......#...#.#...#.....#...#...#.#.#...#.#.....#...###.......#...#.......#.......#...#...#...#.......#.........#...#.#...#...........#.#...#
#######.#.###.#.#.#.###.#.###.###.#.#.#.#.#######.#.###############.#############.#####.#####.#######.#########.#####.#.###.#########.#.###.#
#.......#...#.#.#.#...#.#...#.###.#.#.#.#.###...#.#.....###...#.....#...###.......#...#...#...#...###.#.......#.#.....#.....#.........#.....#
#.#########.#.#.#.###.#.###.#.###.#.#.#.#v###.#.#.#####.###.#.#.#####.#.###.#######.#.###.#.###.#.###.#.#####.#.#.###########v###############
#.........#.#.#.#.#...#...#.#...#.#.#.#.>.>...#.#.#.....#...#.#.......#.#...#...###.#...#.#...#.#...#...#.....#...#...#...#.>.#...#...#...###
#########.#.#.#.#.#.#####.#.###.#.#.#.###v#####.#.#.#####.###.#########.#.###.#.###.###.#.###.#.###.#####.#########.#.#.#.#.#v#.#.#.#.#.#.###
#.........#.#...#.#...###.#.###.#.#...#...###...#.#.#...#...#.#...#.....#...#.#.###.#...#...#.#.#...#...#...###...#.#.#.#.#.#...#.#.#...#...#
#.#########.#####.###.###.#.###.#.#####.#####.###.#.#.#.###.#.#.#.#v#######v#.#.###.#.#####.#.#.#.###.#.###v###.#.#.#.#.#.#.#####.#.#######.#
#.#...#...#.#...#.#...#...#.#...#.#...#.....#.....#.#.#...#.#.#.#.>.>...#.>.>.#...#.#.#...#.#.#.#.#...#...>.>...#.#.#.#.#...###...#.#.......#
#.#.#v#.#.#.#.#.#.#.###.###.#.###.#.#.#####.#######.#.###.#.#.#.###v###.#.#v#####.#.#.#.#.#.#.#.#.#.#######v#####.#.#.#.#######.###.#.#######
#.#.#.>.#.#...#.#...#...#...#.....#.#.#...#.......#.#...#.#.#.#.#...#...#.#.#...#.#.#.#.#.#.#.#.#.#.#.....#.....#...#.#.###...#...#.#.#...###
#.#.#v###.#####.#####.###.#########.#.#.#.#######.#.###.#.#.#.#.#.###.###.#.#.#.#.#.#.#.#.#.#.#.#.#.#.###.#####.#####.#.###.#.###.#.#.#.#.###
#...#...#.......#...#...#...#.......#...#.....#...#.....#...#...#...#.....#...#.#.#.#.#.#...#.#.#.#.#...#.....#.#.....#...#.#.....#.#...#...#
#######.#########.#.###.###.#.###############.#.###################.###########.#.#.#.#.#####.#.#.#.###.#####.#.#.#######.#.#######.#######.#
#.......#.........#...#.#...#.............#...#...#.....###...#...#...#.........#...#...#.....#.#...###.....#.#.#.....#...#.#.......#.....#.#
#.#######.###########.#.#.###############.#.#####.#.###.###.#.#.#.###.#.#################.#####.###########.#.#.#####.#.###.#.#######.###.#.#
#.......#.#.....#.....#...#...#...#.....#.#.......#...#.###.#.#.#...#.#...#...#...#...###.....#.#...........#.#.....#.#.#...#.#.....#...#.#.#
#######.#.#.###.#.#########.#.#.#.#.###.#.###########.#.###.#.#.###.#.###.#.#.#.#.#.#.#######.#.#.###########.#####.#.#.#.###.#.###.###.#.#.#
#.......#.#...#.#.#.....#...#...#...###...#...#.......#.....#.#...#...###...#...#...#.......#...#...........#.......#...#.....#...#.#...#.#.#
#.#######.###.#.#.#.###.#.#################.#.#.#############.###.#########################.###############.#####################.#.#.###.#.#
#...#.....#...#...#.#...#...................#.#.............#...#.#...###...#...............#...#...........###...###...#.........#...#...#.#
###.#.#####.#######.#.#######################.#############.###.#.#.#.###.#.#.###############.#.#.#############.#.###.#.#.#############.###.#
###...#...#.....###.#.#...#...#...........#...#.............###.#...#...#.#...#.....#.........#.#...............#.#...#.#.......#...###.....#
#######.#.#####.###.#.#.#.#.#.#.#########.#.###.###############.#######.#.#####.###.#.#########.#################.#.###.#######.#.#.#########
#####...#.......#...#.#.#.#.#.#.........#...###.............###.......#.#.#...#...#.#...#.......#...........#.....#...#.....###...#.....#...#
#####.###########.###.#.#.#.#.#########.###################.#########.#.#.#.#.###.#.###.#.#######.#########.#.#######.#####.###########.#.#.#
#.....#.....#...#...#.#.#.#.#.#...#.....###...#.....#.......#...#...#...#...#.....#.#...#.......#.........#...#...#...#.....#.......#...#.#.#
#.#####.###.#.#.###.#.#.#.#.#.#.#.#v#######.#.#.###.#.#######.#.#.#.###############.#.#########.#########.#####.#.#.###.#####.#####.#.###.#.#
#.......###.#.#...#.#.#.#.#.#.#.#.>.>.#####.#.#.#...#...#####.#.#.#.###...#...#...#...###.....#.#.....#...#...#.#.#...#.#...#...#...#.....#.#
###########.#.###.#.#.#.#.#.#.#.###v#.#####.#.#.#.#####v#####.#.#.#.###.#.#.#.#.#.#######.###.#.#.###.#v###.#.#.#.###.#.#.#.###v#.#########.#
#...........#...#.#.#.#.#.#.#.#.#...#...#...#.#.#.....>.>.###.#.#.#...#.#.#.#.#.#...#.....###...#...#.>.>.#.#.#.#.#...#.#.#...>.#...#...#...#
#.#############.#.#.#.#.#.#.#.#.#.#####.#.###.#.#######v#.###.#.#.###.#.#.#.#.#.###.#.#############.###v#.#.#.#.#.#.###.#.#####v###.#.#.#.###
#...........#...#.#.#.#.#.#.#...#...###.#.###...#.......#...#.#.#.#...#.#.#.#.#.#...#.....#...#...#.#...#...#...#.#.###...###...###...#...###
###########v#.###.#.#.#.#.#.#######.###.#.#######.#########.#.#.#.#.###.#.#.#.#.#.#######v#.#.#.#.#.#.###########.#.#########.###############
#.......###.>.###.#.#.#.#.#.###...#...#.#.......#.........#.#.#.#.#...#.#.#.#.#.#...#...>.>.#.#.#.#.#...#...#...#...#####...#.#...#...#.....#
#.#####.###v#####.#.#.#.#.#.###.#.###.#.#######.#########.#.#.#.#.###.#.#.#.#.#.###.#.###v###.#.#.#.###.#.#.#.#.#########.#.#.#.#.#.#.#.###.#
#.#...#.....#...#...#...#.#.#...#.....#.........#...#.....#.#.#...#...#.#.#.#.#.#...#.#...###.#.#.#...#...#...#...#.......#.#...#...#...#...#
#.#.#.#######.#.#########.#.#.###################.#.#.#####.#.#####.###.#.#.#.#.#.###.#.#####.#.#.###.###########.#.#######.#############.###
#.#.#.#.......#.........#...#.....#...........#...#.#.....#.#.#.....#...#.#.#.#.#.#...#.....#...#.#...#...........#.#.....#...............###
#.#.#.#.###############.#########.#.#########.#.###.#####.#.#.#.#####.###.#.#.#.#.#.#######.#####.#.###.###########.#.###.###################
#...#.#.#.............#...#.......#.#.........#...#.......#...#.......#...#.#.#.#.#.#.......#...#...###.....#...###...#...#.................#
#####.#.#.###########.###.#.#######.#.###########.#####################.###.#.#.#.#.#.#######.#.###########.#.#.#######.###.###############.#
#.....#.#.........###.....#...#.....#...........#.....#...###.......#...#...#...#...#.........#.#...........#.#.......#.....#.......#.......#
#.#####.#########.###########.#.###############.#####.#.#.###.#####.#.###.#####################.#.###########.#######.#######.#####.#.#######
#.....#.#.........#.....#...#...#...............#####...#.....#.....#...#.#.....................#.............#.......###.....#...#...#.....#
#####.#.#.#########.###.#.#.#####.#############################.#######.#.#.###################################.#########.#####.#.#####.###.#
#...#...#.........#.#...#.#.#...#...............#...............###...#...#.......#.....#...#...#...#.........#.....#.....#...#.#.......#...#
#.#.#############.#.#.###.#.#.#.###############.#.#################.#.###########.#.###.#.#.#.#.#.#.#.#######.#####.#.#####.#.#.#########.###
#.#.............#...#...#.#.#.#.#...#...........#...................#.#.....#.....#.#...#.#.#.#.#.#.#.......#.......#.....#.#...#.....#...###
#.#############.#######.#.#.#.#.#.#.#.###############################.#.###.#.#####.#.###.#.#.#.#.#.#######.#############.#.#####.###.#.#####
#.............#...#.....#.#.#.#.#.#.#.#.........#...............#.....#...#.#.......#.....#...#.#.#.###.....#...###...###...#.....###...#####
#############.###.#.#####.#.#.#.#.#.#.#.#######.#.#############.#.#######.#.###################.#.#.###.#####.#.###.#.#######v###############
#.............###...#...#.#...#...#.#...#.......#.....#...#...#...#...###.#.#...#...###...#.....#.#...#.....#.#.#...#...#...>.#.............#
#.###################.#.#.#########.#####.###########.#.#.#.#.#####.#.###.#.#.#.#.#.###.#.#.#####.###.#####.#.#.#.#####.#.###v#.###########.#
#.....#...#...#...###.#.#...#.......#...#.#...###...#...#...#...#...#...#.#.#.#.#.#.....#...#...#...#.#...#.#.#.#...#...#.###...#...........#
#####.#.#.#.#.#.#.###.#.###.#.#######.#.#v#.#.###.#.###########.#.#####.#.#.#.#.#.###########.#.###.#.#.#.#v#.#.###.#.###.#######.###########
#.....#.#...#.#.#.....#.#...#.#.....#.#.>.>.#...#.#.#...........#.#.....#.#.#.#.#.......#...#.#.#...#.#.#.>.>.#.....#.....#.......#...#...###
#.#####.#####.#.#######.#.###.#.###.#.###v#####.#.#.#v###########.#.#####.#.#.#.#######.#.#.#.#.#.###.#.###v###############.#######.#.#.#.###
#...#...#.....#.......#...#...#.#...#.#...###...#.#.>.>...#.....#.#...###.#.#.#.#...###...#.#.#...###.#...#.#.......###...#.....#...#.#.#.###
###.#.###.###########.#####.###.#.###.#.#####.###.###v###.#.###.#.###.###.#.#.#.#.#.#######.#.#######.###.#.#.#####.###.#.#####.#.###.#.#.###
#...#.#...#...###...#.....#...#.#.....#.#...#...#...#...#...#...#.#...#...#.#.#.#.#.#.....#.#.......#.#...#.#.#.....#...#.......#.#...#.#...#
#.###.#.###.#v###.#.#####.###.#.#######.#.#.###.###.###.#####.###.#.###.###.#.#.#.#.#.###.#.#######.#.#.###.#.#.#####.###########.#.###.###.#
#...#.#...#.#.>...#.......#...#.###...#...#...#.#...###.....#...#.#...#.#...#.#.#.#.#...#...#...#...#...#...#.#.#...#.....#.......#...#.#...#
###.#.###.#.#v#############.###.###.#.#######.#.#.#########.###.#.###.#.#.###.#.#.#.###v#####.#.#.#######.###.#.#.#.#####.#.#########.#.#.###
#...#.###...#...........###.#...#...#.......#.#...#.........###...#...#.#...#.#.#.#...>.>.#...#.#.......#...#.#...#.....#.#.#.........#.#.###
#.###.#################.###.#.###.#########.#.#####.###############.###.###.#.#.#.#####v#.#.###.#######.###.#.#########.#.#.#.#########.#.###
#.....#...#.........#...#...#...#.........#.#.#.....#.....#####...#...#.###.#.#.#.#...#.#.#...#.#...#...#...#.#.........#...#...#...#...#...#
#######.#.#.#######.#.###.#####.#########.#.#.#.#####.###.#####.#.###.#.###.#.#.#.#.#.#.#.###.#.#.#.#.###.###.#.###############.#.#.#.#####.#
#####...#.#...#...#...###.......###.......#...#.....#.###...#...#.#...#...#.#.#.#.#.#...#.....#...#.#.###.....#.........#...###...#.#.#.....#
#####.###.###.#.#.#################.###############.#.#####.#.###.#.#####.#.#.#.#.#.###############.#.#################.#.#.#######.#.#.#####
###...#...###...#.....#.....#.....#.............#...#.###...#.#...#.......#...#.#.#.#.............#...#...###...#.......#.#.#...#...#.#.....#
###.###.#############.#.###.#.###.#############.#.###.###.###.#.###############.#.#.#.###########.#####.#.###.#.#.#######.#.#.#.#.###.#####.#
#...#...###.....#.....#.#...#...#.#...........#.#...#.#...#...#...#.....#.....#...#...#.........#.#.....#.....#...#.....#.#.#.#.#.....#...#.#
#.###.#####.###.#v#####.#.#####.#.#.#########.#.###.#.#.###.#####.#.###.#.###.#########.#######.#.#.###############.###.#.#.#.#.#######v#.#.#
#...#.....#.#...#.>.....#.#...#.#.#.#...#####...###...#.....#...#...#...#.#...#...#...#.......#...#...............#...#...#.#.#.#...#.>.#.#.#
###.#####.#.#.###v#######.#.#.#.#.#.#.#.#####################.#.#####.###.#.###.#.#.#.#######.###################.###.#####.#.#.#.#.#.#v#.#.#
#...#...#...#.#...###.....#.#.#.#.#...#.....#...#...#.......#.#.#...#...#.#...#.#...#.........#...###...........#.#...###...#.#...#...#.#...#
#.###.#.#####.#.#####.#####.#.#.#.#########.#.#.#.#.#.#####.#.#.#.#.###.#.###.#.###############.#.###.#########.#.#.#####.###.#########.#####
#.....#...#...#.#.....#.....#.#.#...###.....#.#.#.#.#...#...#.#...#.....#.#...#.................#...#.....#...#...#.....#.....#.....###...###
#########.#.###.#.#####.#####.#.###.###.#####.#.#.#.###.#.###.###########.#.#######################.#####.#.#.#########.#######.###.#####.###
#.........#.#...#...#...#.....#.#...#...#...#.#...#.###.#.#...#.....#...#.#.###...###...#...........#...#...#.......#...#...###...#.#...#...#
#.#########.#.#####.#.###.#####.#.###.###.#.#.#####.###.#.#.###.###.#.#.#.#.###.#.###.#.#v###########.#.###########.#.###.#.#####.#.#.#.###.#
#.......###.#.....#.#.#...#.....#...#.....#.#.#.....#...#.#.....#...#.#.#.#.#...#.#...#.>.>.#...#...#.#.###...###...#...#.#.......#...#.#...#
#######.###.#####.#.#.#.###.#######.#######.#.#.#####.###.#######.###.#.#.#.#.###.#.#####v#.#.#.#.#.#.#.###.#.###v#####.#.#############.#.###
#.......#...#.....#.#.#...#.#...###...#.....#.#.#...#.#...#...###.###.#.#.#...###...#...#.#.#.#.#.#.#.#.#...#...>.>.#...#.............#.#.###
#.#######.###.#####.#.###.#.#.#.#####.#v#####.#.#.#.#.#.###.#.###v###.#.#.###########.#.#.#.#.#.#.#.#.#.#.#######v#.#.###############.#.#.###
#.......#.....#####.#.###...#.#.#...#.>.>...#.#.#.#.#.#.#...#...>.>.#.#...###...###...#...#...#.#.#...#...#...#...#.#...#.............#...###
#######.###########.#.#######.#.#.#.###v###.#.#.#.#.#.#.#.#######v#.#.#######.#.###.###########.#.#########.#.#.###.###.#.###################
#.....#.........#...#.#...#...#.#.#.#...###.#.#.#.#...#...###.....#...#.......#.....#.........#...#.........#...###.#...#.#.....#...#.......#
#.###.#########.#.###.#.#.#.###.#.#.#.#####.#.#.#.###########.#########.#############.#######.#####.###############.#.###.#.###.#.#.#.#####.#
#...#...........#.....#.#.#...#.#.#.#.....#.#.#.#.###...#...#.........#.#...#.........#.......#...#.#.......#...###...###...###...#...#.....#
###.###################.#.###.#.#.#.#####.#.#.#.#.###.#.#.#.#########.#.#.#.#.#########.#######.#.#.#.#####.#.#.#######################.#####
###.........#...#...###.#.....#.#.#.......#...#.#.#...#...#.###...#...#.#.#.#.#.......#.#...#...#.#...#.....#.#.#...#...###...#.........#####
###########.#.#.#.#.###.#######.#.#############.#.#.#######.###.#.#.###.#.#.#.#.#####.#.#.#.#.###.#####.#####.#.#.#.#.#.###.#.#.#############
#.....#.....#.#...#...#...#...#.#...........###...#.......#...#.#.#...#...#.#.#.....#...#.#.#.#...#...#.......#.#.#...#.#...#.#.............#
#.###.#.#####.#######.###.#.#.#.###########.#############.###.#.#.###.#####.#.#####.#####.#.#.#.###.#.#########.#.#####.#.###.#############.#
#...#...#...#...#.....#...#.#.#...#.......#...#...........###.#.#.....#...#.#.#.....#...#.#.#.#.###.#.#...#.....#.#.....#...#...........#...#
###.#####.#.###.#.#####.###.#.###.#.#####.###.#.#############.#.#######.#.#.#.#.#####.#.#.#.#.#.###.#.#.#.#v#####.#.#######.###########.#.###
#...#...#.#...#.#.#...#.....#...#.#.#...#.....#.......#.....#...###...#.#.#...#.....#.#...#.#.#...#.#.#.#.>.>.#...#.#.....#...........#...###
#.###.#.#.###.#.#.#.#.#########.#.#.#.#.#############.#.###.#######.#.#.#.#########.#.#####.#.###.#.#.#.#####.#.###.#.###.###########.#######
#...#.#...#...#.#.#.#.#.........#...#.#...#...#.....#...#...#.....#.#...#...#...#...#.###...#...#.#.#...###...#.#...#.#...###.........#...###
###.#.#####.###.#.#.#.#.#############.###.#.#.#.###.#####.###.###.#.#######.#.#.#.###.###.#####.#.#.#######.###.#.###.#.#####.#########.#.###
###.#...###.....#...#.#.#.....###...#.#...#.#.#...#.#.....###...#.#...#.....#.#.#...#...#...#...#.#.......#...#.#...#.#.#...#.........#.#.###
###.###.#############.#.#.###.###.#.#.#.###.#.###.#.#.#########.#.###.#.#####.#.###v###.###.#.###.#######.###.#.###.#.#.#.#.#########.#.#.###
###...#...#...........#...###.....#...#.#...#.###.#.#.......###.#.#...#.#...#.#.#.>.>.#.#...#...#.#.....#...#...###.#.#.#.#.###.......#.#.###
#####.###.#.###########################.#.###.###.#.#######.###.#.#.###.#.#.#.#.#.###.#.#.#####.#.#.###.###.#######.#.#.#.#.###.#######.#.###
#####.....#...........#...###...........#...#.#...#.#.......#...#.#.###.#.#...#.#...#.#.#.....#.#...###...#.#.......#.#...#...#...#...#.#...#
#####################.#.#.###v#############.#.#.###.#.#######.###.#.###.#.#####.###.#.#.#####.#.#########.#.#.#######.#######.###.#.#.#.###.#
#.....................#.#.#.>.>.###...#...#.#.#.#...#.....#...#...#...#.#.#.....#...#.#.#.....#...#.....#...#.......#.###.....#...#.#.#.#...#
#.#####################.#.#.###.###.#.#.#.#.#.#.#.#######v#.###.#####.#.#.#.#####.###.#.#.#######.#.###.###########.#.###.#####v###.#.#.#.###
#...#.....#...........#.#.#.#...#...#.#.#.#.#.#.#.#.....>.>.#...#...#.#.#.#.....#.###.#.#.......#...#...#...........#...#.....>.#...#.#.#.###
###.#.###.#.#########.#.#.#.#.###.###.#.#.#.#.#.#.#.#########.###.#.#.#.#.#####.#.###.#.#######.#####.###.#############.#######v#.###.#.#.###
#...#.#...#.#.........#.#.#.#.#...###.#.#.#.#.#.#.#.........#...#.#.#.#.#.#.....#...#.#.#.......#.....###...#.....#...#.#.......#...#.#.#.###
#.###.#.###.#.#########.#.#.#.#.#####.#.#.#.#.#.#.#########.###.#.#.#.#.#.#.#######.#.#.#.#######.#########.#.###.#.#.#.#.#########.#.#.#.###
#.....#.....#...........#...#...#####...#...#...#...........###...#...#...#.........#...#.........#########...###...#...#...........#...#...#
###########################################################################################################################################.#\
"""

matrix = String.split(input, "\n") |> Enum.map(&String.split(&1, "", trim: true))
height = length(matrix)
width = length(Enum.at(matrix, 0))

defmodule DFSCrawler do
  def viz(matrix, path) do
    [{curr_x, curr_y} | _] = path

    v =
      for {row, i} <- Enum.with_index(matrix) do
        for {cell, j} <- Enum.with_index(row) do
          cond do
            {i, j} == {curr_x, curr_y} -> "X"
            {i, j} in path -> "O"
            true -> cell
          end
        end
        |> Enum.join()
      end
      |> Enum.join("\n")

    IO.puts(v)
    IO.puts("")
  end

  def crawl(_matrix, stack, straights, intersections, _visited) when length(stack) == 0 do
    {straights, intersections}
  end

  # goal is to find straights and intersections in only the direction of the DFS in single pass
  # stack = [%{x, y, path: [{x, y}]}]
  # straights = %{{start_x, start_y} => [{x, y}]}
  # intersections = [{{x, y}, {next_x, next_y}}]
  # visited = [{x, y}]
  def crawl(matrix, stack, straights, intersections, visited) do
    height = length(matrix)
    width = length(Enum.at(matrix, 0))
    [curr | rest] = stack
    %{x: curr_x, y: curr_y, path: curr_path, straight_start_i: curr_straight_start_i} = curr
    new_path = [{curr_x, curr_y} | curr_path]
    next_visited = [{curr_x, curr_y} | visited]
    # dbg(length(stack))

    if curr_x == height - 1 do
      if curr_straight_start_i < length(new_path) - 1 do
        new_straight = Enum.slice(new_path, 0..(-curr_straight_start_i - 1)) |> Enum.reverse()
        [straight_start | _] = new_straight
        next_straights = straights |> Map.put(straight_start, new_straight)
        # dbg(["found path", new_straight, straight_start])
        crawl(matrix, rest, next_straights, intersections, next_visited)
      else
        crawl(matrix, rest, straights, intersections, next_visited)
      end
    else
      straight = straights[{curr_x, curr_y}]

      {curr_x, curr_y, new_path, curr_straight_start_i} =
        if straight != nil do
          # dbg(["found known straight", Enum.at(straight, 0), Enum.at(straight, -1)])
          # found known straight, skip to end of straight and add to path
          straight_reversed = Enum.reverse(straight)
          [{last_x, last_y} | _] = straight_reversed
          new_path2 = Enum.reverse(straight) ++ curr_path
          new_straight_start_i = length(new_path2)
          {last_x, last_y, new_path2, new_straight_start_i}
        else
          {curr_x, curr_y, new_path, curr_straight_start_i}
        end

      next_deltas = [{-1, 0}, {0, 1}, {1, 0}, {0, -1}]

      next_xys =
        for {dx, dy} <- next_deltas do
          next_x = curr_x + dx
          next_y = curr_y + dy

          if 0 <= next_x && next_x < height && 0 <= next_y && next_y < width &&
               {next_x, next_y} not in visited do
            next_char = matrix |> Enum.at(next_x) |> Enum.at(next_y)

            if next_char != "#" do
              # %{x: next_x, y: next_y, path: new_path}
              {next_x, next_y}
            end
          end
        end
        |> Enum.filter(& &1)

      next_straights =
        case length(next_xys) do
          # still going straight
          1 ->
            straights

          # dead end or branches
          l ->
            if curr_straight_start_i < length(new_path) - 1 do
              straight_end_i = if l == 0, do: 0, else: 1

              # reversed cos we nodes are prepended into path
              new_straight_reversed =
                Enum.slice(new_path, straight_end_i..(-curr_straight_start_i - 1))

              [straight_end | _] = new_straight_reversed
              new_straight = new_straight_reversed |> Enum.reverse()
              [straight_start | _] = new_straight

              straights
              |> Map.put(straight_start, new_straight)
              |> Map.put(straight_end, new_straight_reversed)
            else
              straights
            end
        end

      # if curr is branch node, start new straight ahead
      next_straight_start_i =
        if length(next_xys) > 1, do: length(new_path), else: curr_straight_start_i

      next_intersections =
        if length(next_xys) > 1 do
          [Enum.slice(new_path, 0..1) |> List.to_tuple()] ++
            (next_xys |> Enum.map(&{{curr_x, curr_y}, &1})) ++ intersections
        else
          intersections
        end

      nexts =
        next_xys
        |> Enum.map(fn {next_x, next_y} ->
          %{x: next_x, y: next_y, path: new_path, straight_start_i: next_straight_start_i}
        end)

      crawl(matrix, nexts ++ rest, next_straights, next_intersections, next_visited)
    end
  end
end

# prints maze with path
viz = fn path ->
  v =
    for {row, i} <- Enum.with_index(matrix) do
      for {cell, j} <- Enum.with_index(row) do
        if {i, j} in path, do: "O", else: cell
      end
      |> Enum.join()
    end
    |> Enum.join("\n")

  IO.puts(v)
end

# prints edges as graphviz dot graph
viz2 = fn edges ->
  sorted_weights = edges |> Enum.map(&elem(&1, 2)) |> Enum.sort()

  lines =
    for {{x1, y1}, {x2, y2}, len} <- edges do
      r =
        round(Enum.find_index(sorted_weights, &(&1 == len)) / length(sorted_weights) * 255)
        |> Integer.to_string(16)
        |> String.pad_leading(2, "0")

      ~s("#{x1},#{y1}" -> "#{x2},#{y2}" [label="#{len}", color="##{r}8080"];)
    end
    |> Enum.join("\n")

  IO.puts("digraph G {")
  IO.puts("edge [dir=none, penwidth=5]")
  IO.puts(lines)
  IO.puts("}")
end

{straights, intersections} =
  DFSCrawler.crawl(matrix, [%{x: 0, y: 1, path: [], straight_start_i: 0}], %{}, [], [])

straight_edges =
  for {src, path} <- straights, reduce: [] do
    acc ->
      dst = Enum.at(path, -1)

      if Enum.find(acc, fn {src, _, _} -> src == dst end) != nil,
        do: acc,
        else: [{src, dst, length(path) - 1} | acc]
  end

intersections_edges = for {first, last} <- intersections, do: {first, last, 1}

# edges = [{{x,y}, {x,y}, len}]
edges = straight_edges ++ intersections_edges
# viz2.(edges)

# edges_count = Enum.uniq_by(edges, fn {src, dst, _} -> min(src, dst) end) |> length()
# dbg(edges_count)

# adjlist = %{{x, y} => [{x, y, len}]}
adjlist =
  for {{src_x, src_y}, {dst_x, dst_y}, len} <- edges, reduce: %{} do
    # [{{src_x, src_y}, {dst_x, dst_y, len}}, {{dst_x, dst_y}, {src_x, src_y, len}}]
    acc ->
      acc
      |> Map.update({src_x, src_y}, [{dst_x, dst_y, len}], fn adj ->
        [{dst_x, dst_y, len} | adj]
      end)
      |> Map.update({dst_x, dst_y}, [{src_x, src_y, len}], fn adj ->
        [{src_x, src_y, len} | adj]
      end)
  end

# nodes_count = Enum.count(adjlist)
# dbg(nodes_count)

reduced_intersection_edges =
  for {i1, straight_start1} <- intersections, reduce: [] do
    acc ->
      straight_end1 = straights[straight_start1] |> Enum.at(-1)

      acc =
        if straight_end1 in [{0, 1}, {height - 1, width - 2}] do
          [{i1, straight_end1, length(straights[straight_start1])} | acc]
        else
          acc
        end

      (for {i2, straight_start2} <- intersections, i1 != i2 do
         if i2 not in Enum.map(acc, fn {acc_i1, _, _} -> acc_i1 end) do
           if straight_end1 == straight_start2 do
             len = length(straights[straight_start1]) + 1
             {i1, i2, len}
           end
         end
       end
       |> Enum.filter(& &1)) ++ acc
  end

# dbg(length(reduced_intersection_edges))
# dbg(reduced_intersection_edges, limit: :infinity)
# viz2.(reduced_intersection_edges)

intersection_adjlist =
  for {{i1x, i1y}, {i2x, i2y}, len} <- reduced_intersection_edges, reduce: %{} do
    acc ->
      Map.update(acc, {i1x, i1y}, [{i2x, i2y, len}], &[{i2x, i2y, len} | &1])
      |> Map.update({i2x, i2y}, [{i1x, i1y, len}], &[{i1x, i1y, len} | &1])
  end

# dbg(Enum.count(intersection_adjlist))

defmodule LongestPathFinderDFS do
  def crawl(_adjlist, _exit_xy, stack, longest_path, max_path_dist) when length(stack) == 0 do
    {longest_path, max_path_dist}
  end

  # stack = [{x, y, path, visited set}]
  def crawl(adjlist, exit_xy, stack, longest_path, max_path_dist) do
    [curr | rest] = stack
    {curr_x, curr_y, curr_path, curr_visited, curr_sum_dist} = curr
    new_path = [{curr_x, curr_y} | curr_path]
    new_visited = MapSet.union(curr_visited, MapSet.new([{curr_x, curr_y}]))

    if {curr_x, curr_y} == exit_xy do
      new_max_path_dist = max(curr_sum_dist, max_path_dist)

      new_longest_path =
        if new_max_path_dist > max_path_dist do
          new_path
        else
          longest_path
        end

      crawl(adjlist, exit_xy, rest, new_longest_path, new_max_path_dist)
    else
      nexts =
        Enum.reduce_while(adjlist[{curr_x, curr_y}], [], fn {next_x, next_y, len}, acc ->
          # optimization based on visualization: only 1 intersection goes to exit so if exit is one of possible nexts, means we are at the last intersection and must take it
          if {next_x, next_y} == exit_xy do
            {:halt, [{next_x, next_y, new_path, new_visited, curr_sum_dist + len}]}
          else
            if {next_x, next_y} not in new_visited,
              do: {:cont, [{next_x, next_y, new_path, new_visited, curr_sum_dist + len} | acc]},
              else: {:cont, acc}
          end
        end)
        |> Enum.filter(& &1)

      crawl(adjlist, exit_xy, nexts ++ rest, longest_path, max_path_dist)
    end
  end
end

exit_node = {height - 1, width - 2}

{longest_path, max_path_dist} =
  LongestPathFinderDFS.crawl(
    intersection_adjlist,
    exit_node,
    [{0, 1, [], MapSet.new(), 0}],
    [],
    0
  )

# dbg("DONE FINDING PATHS!!!")

ans = max_path_dist
dbg(ans)
# 6394
# took 1m 19s using intersection_adjlist, ie fully contracted to only intersections and entry and exit nodes, 36 nodes + 60 edges
# took 17m 29s using adjlist, ie only partially contracted to straights and intersections, 154 nodes + 140 edges

# intersections form a grid graph with 34 nodes and

dbg(longest_path, limit: :infinity)

# reconstruct path from intersections
longest_path_full =
  for [xy1, xy2] <- longest_path |> Enum.reverse() |> Enum.chunk_every(2, 1, :discard),
      reduce: [] do
    acc ->
      if xy1 not in acc do
        straight_path = Map.get(straights, xy1)

        if straight_path != nil do
          acc ++ straight_path
        else
          # is intersection
          intersection_segment =
            for {ixy, straight_start1} <- intersections, ixy == xy1 do
              straight_end1 = straights[straight_start1] |> Enum.at(-1)

              if Enum.find(intersections, fn {jxy, straight_start2} ->
                   jxy == xy2 && straight_end1 == straight_start2
                 end) != nil || straight_end1 == exit_node do
                straights[straight_start1]
              end
            end
            |> Enum.filter(& &1)
            |> Enum.flat_map(& &1)

          acc ++ [xy1 | intersection_segment]
        end
      else
        acc
      end
  end

dbg(longest_path_full, limit: :infinity)

viz.(longest_path_full)

# #O###########################################################################################################################################
# #O#OOO#OOO#OOO#OOO#OOO#OOOOOOOOO#OOOOOOO#OOO#OOOOOOO#OOO###OOO###OOO#OOO#OOO#OOO###OOO#OOO#OOO#OOO#OOOOO###OOO#OOO###OOO#OOOOO#OOO#OOO#OOO###
# #O#O#O#O#O#O#O#O#O#O#O#O#######O#O#####O#O#O#O#####O#O#O###O#O###O#O#O#O#O#O#O#O###O#O#O#O#O#O#O#O#O###O###O#O#O#O###O#O#O###O#O#O#O#O#O#O###
# #O#O#O#O#O#O#O#O#O#O#OOO#OOOOOOO#OOOOO#O#O#O#OOOOO#OOO#OOO#O#O#OOO#O#O#OOO#O#O#OOO#O#O#O#O#O#O#O#O#O#OOO#OOO#O#O#OOO#O#O#OOO#O#O#OOO#OOO#OOO#
# #O#O#O#O#O#O#O#O#O#O#####O###########O#O#O#O#####O#######O#O#O#O###O#O#####O#O###O#O#O#O#O#O#O#O#O#O#O###O###O#O###O#O#O###O#O#O###########O#
# #OOO#OOO#OOO#OOO#OOO#OOOOO#OOO#OOO#OOO#OOO#OOO#OOO#OOOOOOO#O#OOO#OOO#O#OOOOO#OOO#O#O#OOO#O#O#O#O#OOO#OOO#OOO#O#O#OOO#O#O###O#O#O#OOOOOOOOOOO#
# #########v###########O#####O#O#O#O#O#########O#O###O#######O#####O###O#O#######O#O#O#####O#O#O#O#######O###O#O#O#O###O#O###O#O#O#O###########
# #...#...#.#OOOOOOOOOOO#OOO#O#O#O#O#OOOOOOO#OOO#OOO#O#OOO###O#OOOOO###O#O#OOO###O#O#OOOOO#O#O#O#O#OOOOOOO#OOO#OOO#OOO#O#OOO#O#O#O#O#OOO#OOO###
# #.#.#.#.#.#O###########O#O#O#O#O#O#######O#O#####O#O#O#O###O#O#######O#O#O#O###O#O#####O#O#O#O#O#O#######O#########O#O###O#O#O#O#O#O#O#O#O###
# #.#...#...#OOO#OOO###OOO#OOO#O#O#O###OOO#O#O#OOO#O#O#O#O#OOO#OOOOOOO#O#O#O#O#OOO#O#OOO#O#O#O#O#O#O#OOO###OOOOO#####O#O#OOO#O#O#O#OOO#OOO#OOO#
# #.###########O#O#O###O#######O#O#O###O#O#O#O#O#O#O#O#O#O#O#######v#O#O#O#O#O#O###O#O#O#O#O#O#O#O#O#O#O#######O#####O#O#O###O#O#O###########O#
# #.........###O#O#OOO#OOO#OOOOO#O#OOOOO#O#O#OOO#O#O#O#O#O#OOO#.....#OOO#O#O#O#OOO#O#O#O#O#O#O#O#O#O#O#OOOOOOO#OOOOO#OOO#OOOOO#OOO#OOO#OOOOOOO#
# #########.###O#O###O###O#O#####O#######O#O#####O#O#O#O#O###O#.#########O#O#O###O#O#O#O#O#O#O#O#O#O#O###v###O#####O###############O#O#O#######
# #####...#.#OOO#OOO#OOO#O#O#OOO#OOOOOOO#O#OOOOO#O#O#OOO#O#OOO#.#...###OOO#O#O#OOO#OOO#O#O#O#O#OOO#O#OOO#...#OOO#OOO###OOO#OOO###OOO#O#OOOOOOO#
# #####.#.#.#O#####O###O#O#O#O#O#######O#O#####O#O#O#####O#O###.#.#.###O###O#O#O#######O#O#O#O#####O###O###.###O#O#####O#O#O#O###O###O#######O#
# #.....#...#OOOOOOO###O#O#OOO#O#OOOOOOO#OOOOOOO#OOO#...#O#OOO#...#...#OOOOO#O#O#OOO###OOO#O#O#OOOOO#OOO###...#OOO#OOOOO#OOO#OOOOO###OOO#OOOOO#
# #.###################O#O#####O#O#v#################.#.#O###O#######.#######O#O#O#O#######O#O#O#####O#######.#####O###################O#O#####
# #...........#OOOOOOOOO#O#OOOOO#O#...#...###...###...#.#O#OOO###...#.....#OOO#OOO#OOOOOOO#O#O#O#OOO#O#.....#.....#OOO#OOOOOOOOOOOOO#OOO#OOOOO#
# ###########.#O#########O#O#####O###.#.#.###.#.###.###.#O#O#####.#.#####.#O#############O#O#O#O#O#O#O#.###.#####.###O#O###########O#O#######O#
# #...........#OOOOO#OOO#O#O#OOO#O#...#.#.....#.....#...#O#O#...#.#.......#OOOOOOOOO#OOOOO#O#O#O#O#OOO#.#...#...#...#O#O#OOOOOOOOOOO#OOO#OOOOO#
# #.###############O#O#O#O#O#O#O#O#.###.#############.###O#O#.#.#.###########v#####O#O#####O#O#O#O#####.#.###.#.###.#O#O#O#############O#O#####
# #.........#OOOOO#O#O#O#O#OOO#OOO#.....#.....#.....#...#OOO#.#...#...###...#.....#O#OOOOO#OOO#OOO#...#.#.#...#.....#OOO#OOOOOOOOOOOOO#O#OOOOO#
# #########.#O###O#O#O#O#O###############.###.#.###.###.#####.#####.#.###.#.#####.#O#####O#########.#.#.#.#.#########################O#O#####O#
# #.........#O#OOO#OOO#OOO###OOOOO#OOO###...#.#...#.....#.....#...#.#.....#.#.....#OOO#OOO#OOO###...#...#.#.........#...###OOOOOOOOOOO#OOO#OOO#
# #.#########O#O#############O###O#O#O#####.#.###.#######.#####.#.#.#######.#.#######O#O###O#O###.#######.#########.#.#.###O#############O#O###
# #.......#OOO#O#OOO#OOOOO#OOO#OOO#O#O#OOO#.#.....#OOO###.......#...#.......#.......#OOO#OOO#OOO#.......#.........#...#.#OOO#OOOOOOOOOOO#O#OOO#
# #######.#O###O#O#O#O###O#O###O###O#O#O#O#.#######O#O###############.#############.#####O#####O#######.#########.#####.#O###O#########O#O###O#
# #.......#OOO#O#O#O#OOO#O#OOO#O###O#O#O#O#.###OOO#O#OOOOO###OOO#.....#...###.......#OOO#OOO#OOO#OOO###.#.......#.#.....#OOOOO#OOOOOOOOO#OOOOO#
# #.#########O#O#O#O###O#O###O#O###O#O#O#O#v###O#O#O#####O###O#O#.#####.#.###.#######O#O###O#O###O#O###.#.#####.#.#.###########O###############
# #.........#O#O#O#O#OOO#OOO#O#OOO#O#O#O#OOOOOOO#O#O#OOOOO#OOO#O#.......#.#...#OOO###O#OOO#O#OOO#O#OOO#...#.....#...#...#...#.>O#OOO#OOO#OOO###
# #########.#O#O#O#O#O#####O#O###O#O#O#O###v#####O#O#O#####O###O#########.#.###O#O###O###O#O###O#O###O#####.#########.#.#.#.#.#O#O#O#O#O#O#O###
# #.........#O#OOO#O#OOO###O#O###O#O#OOO#...###OOO#O#O#OOO#OOO#O#OOO#.....#...#O#O###O#OOO#OOO#O#O#OOO#OOO#...###...#.#.#.#.#.#OOO#O#O#OOO#OOO#
# #.#########O#####O###O###O#O###O#O#####.#####O###O#O#O#O###O#O#O#O#v#######v#O#O###O#O#####O#O#O#O###O#O###v###.#.#.#.#.#.#.#####O#O#######O#
# #.#...#OOO#O#OOO#O#OOO#OOO#O#OOO#O#...#.....#OOOOO#O#O#OOO#O#O#O#OOO>...#.>OOO#OOO#O#O#OOO#O#O#O#O#OOO#OOOOO>...#.#.#.#.#...###OOO#O#OOOOOOO#
# #.#.#v#O#O#O#O#O#O#O###O###O#O###O#.#.#####.#######O#O###O#O#O#O###O###.#.#O#####O#O#O#O#O#O#O#O#O#O#######O#####.#.#.#.#######O###O#O#######
# #.#.#OOO#O#OOO#O#OOO#OOO#OOO#OOOOO#.#.#...#.......#O#OOO#O#O#O#O#OOO#...#.#O#OOO#O#O#O#O#O#O#O#O#O#O#OOOOO#OOOOO#...#.#.###OOO#OOO#O#O#OOO###
# #.#.#O###O#####O#####O###O#########.#.#.#.#######.#O###O#O#O#O#O#O###.###.#O#O#O#O#O#O#O#O#O#O#O#O#O#O###O#####O#####.#.###O#O###O#O#O#O#O###
# #...#OOO#OOOOOOO#OOO#OOO#OOO#.......#...#.....#...#OOOOO#OOO#OOO#OOO#.....#OOO#O#O#O#O#O#OOO#O#O#O#O#OOO#OOOOO#O#.....#...#O#OOOOO#O#OOO#OOO#
# #######O#########O#O###O###O#.###############.#.###################O###########O#O#O#O#O#####O#O#O#O###O#####O#O#.#######.#O#######O#######O#
# #OOOOOOO#OOOOOOOOO#OOO#O#OOO#.............#...#...#OOOOO###OOO#OOO#OOO#OOOOOOOOO#OOO#OOO#OOOOO#O#OOO###OOOOO#O#O#.....#...#O#OOOOOOO#OOOOO#O#
# #O#######O###########O#O#O###############.#.#####.#O###O###O#O#O#O###O#O#################O#####O###########O#O#O#####.#.###O#O#######O###O#O#
# #OOOOOOO#O#OOOOO#OOOOO#OOO#...#...#.....#.#.......#OOO#O###O#O#O#OOO#O#OOO#OOO#OOO#OOO###OOOOO#O#OOOOOOOOOOO#O#OOOOO#.#.#OOO#O#OOOOO#OOO#O#O#
# #######O#O#O###O#O#########.#.#.#.#.###.#.###########O#O###O#O#O###O#O###O#O#O#O#O#O#O#######O#O#O###########O#####O#.#.#O###O#O###O###O#O#O#
# #OOOOOOO#O#OOO#O#O#.....#...#...#...###...#...#OOOOOOO#OOOOO#O#OOO#OOO###OOO#OOO#OOO#OOOOOOO#OOO#OOOOOOOOOOO#OOOOOOO#...#OOOOO#OOO#O#OOO#O#O#
# #O#######O###O#O#O#.###.#.#################.#.#O#############O###O#########################O###############O#####################O#O#O###O#O#
# #OOO#OOOOO#OOO#OOO#.#...#...................#.#OOOOOOOOOOOOO#OOO#O#OOO###OOO#OOOOOOOOOOOOOOO#OOO#OOOOOOOOOOO###OOO###...#OOOOOOOOO#OOO#OOO#O#
# ###O#O#####O#######.#.#######################.#############O###O#O#O#O###O#O#O###############O#O#O#############O#O###.#.#O#############O###O#
# ###OOO#OOO#OOOOO###.#.#...#...#...........#...#OOOOOOOOOOOOO###O#OOO#OOO#O#OOO#OOOOO#OOOOOOOOO#O#OOOOOOOOOOOOOOO#O#...#.#OOOOOOO#OOO###OOOOO#
# #######O#O#####O###.#.#.#.#.#.#.#########.#.###O###############O#######O#O#####O###O#O#########O#################O#.###.#######O#O#O#########
# #####OOO#OOOOOOO#...#.#.#.#.#.#.........#...###OOOOOOOOOOOOO###OOOOOOO#O#O#OOO#OOO#O#OOO#OOOOOOO#OOOOOOOOOOO#OOOOO#...#.....###OOO#OOOOO#OOO#
# #####O###########.###.#.#.#.#.#########.###################O#########O#O#O#O#O###O#O###O#O#######O#########O#O#######.#####.###########O#O#O#
# #OOOOO#OOOOO#...#...#.#.#.#.#.#...#.....###...#.....#OOOOOOO#OOO#OOO#OOO#OOO#OOOOO#O#OOO#OOOOOOO#OOOOOOOOO#OOO#...#...#.....#OOOOOOO#OOO#O#O#
# #O#####O###O#.#.###.#.#.#.#.#.#.#.#v#######.#.#.###.#O#######O#O#O#O###############O#O#########O#########O#####.#.#.###.#####O#####O#O###O#O#
# #OOOOOOO###O#.#...#.#.#.#.#.#.#.#.>.>.#####.#.#.#...#OOO#####O#O#O#O###OOO#OOO#OOO#OOO###OOOOO#O#.....#OOO#...#.#.#...#.#...#OOO#OOO#OOOOO#O#
# ###########O#.###.#.#.#.#.#.#.#.###v#.#####.#.#.#.#####O#####O#O#O#O###O#O#O#O#O#O#######O###O#O#.###.#O###.#.#.#.###.#.#.#.###O#O#########O#
# #OOOOOOOOOOO#...#.#.#.#.#.#.#.#.#...#...#...#.#.#.....>OOO###O#O#O#OOO#O#O#O#O#O#OOO#OOOOO###OOO#...#.>O>.#.#.#.#.#...#.#.#...>O#OOO#OOO#OOO#
# #O#############.#.#.#.#.#.#.#.#.#.#####.#.###.#.#######v#O###O#O#O###O#O#O#O#O#O###O#O#############.###O#.#.#.#.#.#.###.#.#####O###O#O#O#O###
# #OOOOOOOOOOO#...#.#.#.#.#.#.#...#...###.#.###...#.......#OOO#O#O#O#OOO#O#O#O#O#O#OOO#OOOOO#...#...#.#OOO#...#...#.#.###...###OOO###OOO#OOO###
# ###########O#.###.#.#.#.#.#.#######.###.#.#######.#########O#O#O#O#O###O#O#O#O#O#O#######O#.#.#.#.#.#O###########.#.#########O###############
# #OOOOOOO###O>.###.#.#.#.#.#.###...#...#.#.......#.........#O#O#O#O#OOO#O#O#O#O#O#OOO#OOOOO>.#.#.#.#.#OOO#OOO#OOO#...#####OOO#O#OOO#OOO#OOOOO#
# #O#####O###O#####.#.#.#.#.#.###.#.###.#.#######.#########.#O#O#O#O###O#O#O#O#O#O###O#O###v###.#.#.#.###O#O#O#O#O#########O#O#O#O#O#O#O#O###O#
# #O#OOO#OOOOO#OOO#...#...#.#.#...#.....#.........#...#.....#O#O#OOO#OOO#O#O#O#O#O#OOO#O#...###.#.#.#...#OOO#OOO#OOO#OOOOOOO#O#OOO#OOO#OOO#OOO#
# #O#O#O#######O#O#########.#.#.###################.#.#.#####O#O#####O###O#O#O#O#O#O###O#.#####.#.#.###.###########O#O#######O#############O###
# #O#O#O#OOOOOOO#OOOOOOOOO#...#.....#...........#...#.#.....#O#O#OOOOO#OOO#O#O#O#O#O#OOO#.....#...#.#...#OOOOOOOOOOO#O#OOOOO#OOOOOOOOOOOOOOO###
# #O#O#O#O###############O#########.#.#########.#.###.#####.#O#O#O#####O###O#O#O#O#O#O#######.#####.#.###O###########O#O###O###################
# #OOO#O#O#OOOOOOOOOOOOO#OOO#.......#.#.........#...#.......#OOO#OOOOOOO#OOO#O#O#O#O#O#.......#...#...###OOOOO#OOO###OOO#OOO#OOOOOOOOOOOOOOOOO#
# #####O#O#O###########O###O#.#######.#.###########.#####################O###O#O#O#O#O#.#######.#.###########O#O#O#######O###O###############O#
# #OOOOO#O#OOOOOOOOO###OOOOO#...#.....#...........#.....#...###.......#OOO#OOO#OOO#OOO#.........#.#OOOOOOOOOOO#O#OOOOOOO#OOOOO#OOOOOOO#OOOOOOO#
# #O#####O#########O###########.#.###############.#####.#.#.###.#####.#O###O#####################.#O###########O#######O#######O#####O#O#######
# #OOOOO#O#OOOOOOOOO#OOOOO#OOO#...#...............#####...#.....#.....#OOO#O#.....................#OOOOOOOOOOOOO#OOOOOOO###OOOOO#OOO#OOO#OOOOO#
# #####O#O#O#########O###O#O#O#####.#############################.#######O#O#.###################################O#########O#####O#O#####O###O#
# #OOO#OOO#OOOOOOOOO#O#OOO#O#O#OOO#...............#...............###...#OOO#.......#.....#...#...#...#OOOOOOOOO#OOOOO#OOOOO#OOO#O#OOOOOOO#OOO#
# #O#O#############O#O#O###O#O#O#O###############.#.#################.#.###########.#.###.#.#.#.#.#.#.#O#######O#####O#O#####O#O#O#########O###
# #O#OOOOOOOOOOOOO#OOO#OOO#O#O#O#O#OOO#...........#...................#.#OOOOO#.....#.#...#.#.#.#.#.#.#OOOOOOO#OOOOOOO#OOOOO#O#OOO#OOOOO#OOO###
# #O#############O#######O#O#O#O#O#O#O#.###############################.#O###O#.#####.#.###.#.#.#.#.#.#######O#############O#O#####O###O#O#####
# #OOOOOOOOOOOOO#OOO#OOOOO#O#O#O#O#O#O#.#.........#...............#.....#OOO#O#.......#.....#...#.#.#.###OOOOO#...###...###OOO#OOOOO###OOO#####
# #############O###O#O#####O#O#O#O#O#O#.#.#######.#.#############.#.#######O#O###################.#.#.###O#####.#.###.#.#######O###############
# #OOOOOOOOOOOOO###OOO#OOO#O#OOO#OOO#O#...#.......#.....#...#...#...#OOO###O#O#OOO#...###...#.....#.#...#OOOOO#.#.#...#...#...>O#OOOOOOOOOOOOO#
# #O###################O#O#O#########O#####.###########.#.#.#.#.#####O#O###O#O#O#O#.#.###.#.#.#####.###.#####O#.#.#.#####.#.###O#O###########O#
# #OOOOO#OOO#OOO#OOO###O#O#OOO#OOOOOOO#OOO#.#...###...#...#...#...#OOO#OOO#O#O#O#O#.#.....#...#...#...#.#...#O#.#.#...#...#.###OOO#OOOOOOOOOOO#
# #####O#O#O#O#O#O#O###O#O###O#O#######O#O#v#.#.###.#.###########.#O#####O#O#O#O#O#.###########.#.###.#.#.#.#O#.#.###.#.###.#######O###########
# #OOOOO#O#OOO#O#O#OOOOO#O#OOO#O#OOOOO#O#OOO>.#...#.#.#...........#O#OOOOO#O#O#O#O#.......#...#.#.#...#.#.#.>O>.#.....#.....#OOOOOOO#OOO#OOO###
# #O#####O#####O#O#######O#O###O#O###O#O###O#####.#.#.#v###########O#O#####O#O#O#O#######.#.#.#.#.#.###.#.###O###############O#######O#O#O#O###
# #OOO#OOO#OOOOO#OOOOOOO#OOO#OOO#O#OOO#O#OOO###...#.#.>OOOOO#OOOOO#O#OOO###O#O#O#O#OOO###...#.#.#...###.#...#O#OOOOOOO###OOO#OOOOO#OOO#O#O#O###
# ###O#O###O###########O#####O###O#O###O#O#####.###.###O###O#O###O#O###O###O#O#O#O#O#O#######.#.#######.###.#O#O#####O###O#O#####O#O###O#O#O###
# #OOO#O#OOO#OOO###OOO#OOOOO#OOO#O#OOOOO#O#OOO#...#...#OOO#OOO#OOO#O#OOO#OOO#O#O#O#O#O#.....#.#.......#.#...#O#O#OOOOO#OOO#OOOOOOO#O#OOO#O#OOO#
# #O###O#O###O#O###O#O#####O###O#O#######O#O#O###.###.###O#####O###O#O###O###O#O#O#O#O#.###.#.#######.#.#.###O#O#O#####O###########O#O###O###O#
# #OOO#O#OOO#O#OOOOO#OOOOOOO#OOO#O###OOO#OOO#OOO#.#...###OOOOO#OOO#O#OOO#O#OOO#O#O#O#O#...#...#...#...#...#OOO#O#O#OOO#OOOOO#OOOOOOO#OOO#O#OOO#
# ###O#O###O#O#v#############O###O###O#O#######O#.#.#########O###O#O###O#O#O###O#O#O#O###v#####.#.#.#######O###O#O#O#O#####O#O#########O#O#O###
# #OOO#O###OOO#...........###O#OOO#OOO#OOOOOOO#O#...#OOOOOOOOO###OOO#OOO#O#OOO#O#O#O#OOOOO>.#...#.#.......#OOO#O#OOO#OOOOO#O#O#OOOOOOOOO#O#O###
# #O###O#################.###O#O###O#########O#O#####O###############O###O###O#O#O#O#####O#.#.###.#######.###O#O#########O#O#O#O#########O#O###
# #OOOOO#OOO#.........#...#OOO#OOO#OOOOOOOOO#O#O#OOOOO#OOOOO#####OOO#OOO#O###O#O#O#O#OOO#O#.#...#.#...#...#OOO#O#OOOOOOOOO#OOO#OOO#OOO#OOO#OOO#
# #######O#O#.#######.#.###O#####O#########O#O#O#O#####O###O#####O#O###O#O###O#O#O#O#O#O#O#.###.#.#.#.#.###O###O#O###############O#O#O#O#####O#
# #####OOO#O#...#...#...###OOOOOOO###OOOOOOO#OOO#OOOOO#O###OOO#OOO#O#OOO#OOO#O#O#O#O#O#OOO#.....#...#.#.###OOOOO#OOOOOOOOO#OOO###OOO#O#O#OOOOO#
# #####O###O###.#.#.#################O###############O#O#####O#O###O#O#####O#O#O#O#O#O###############.#.#################O#O#O#######O#O#O#####
# ###OOO#OOO###...#.....#OOOOO#OOOOO#OOOOOOOOOOOOO#OOO#O###OOO#O#OOO#OOOOOOO#OOO#O#O#O#OOOOOOOOOOOOO#...#OOO###OOO#OOOOOOO#O#O#OOO#OOO#O#OOOOO#
# ###O###O#############.#O###O#O###O#############O#O###O###O###O#O###############O#O#O#O###########O#####O#O###O#O#O#######O#O#O#O#O###O#####O#
# #OOO#OOO###OOOOO#.....#O#OOO#OOO#O#OOOOOOOOOOO#O#OOO#O#OOO#OOO#OOO#OOOOO#.....#OOO#OOO#OOOOOOOOO#O#OOOOO#OOOOO#OOO#OOOOO#O#O#O#O#OOOOO#OOO#O#
# #O###O#####O###O#v#####O#O#####O#O#O#########O#O###O#O#O###O#####O#O###O#.###.#########O#######O#O#O###############O###O#O#O#O#O#######O#O#O#
# #OOO#OOOOO#O#OOO#OOOOOOO#O#OOO#O#O#O#OOO#####OOO###OOO#OOOOO#OOO#OOO#OOO#.#...#OOO#OOO#OOOOOOO#OOO#OOOOOOOOOOOOOOO#OOO#OOO#O#O#O#OOO#OOO#O#O#
# ###O#####O#O#O###O#######O#O#O#O#O#O#O#O#####################O#O#####O###.#.###O#O#O#O#######O###################O###O#####O#O#O#O#O#O#v#O#O#
# #OOO#OOO#OOO#O#OOO###OOOOO#O#O#O#O#OOO#OOOOO#...#...#.......#O#O#OOO#OOO#.#...#O#OOO#OOOOOOOOO#OOO###OOOOOOOOOOO#O#OOO###OOO#O#OOO#OOO#.#OOO#
# #O###O#O#####O#O#####O#####O#O#O#O#########O#.#.#.#.#.#####.#O#O#O#O###O#.###.#O###############O#O###O#########O#O#O#####O###O#########.#####
# #OOOOO#OOO#OOO#O#OOOOO#OOOOO#O#O#OOO###OOOOO#.#.#.#.#...#...#O#OOO#OOOOO#.#...#OOOOOOOOOOOOOOOOO#OOO#OOOOO#OOO#OOO#OOOOO#OOOOO#.....###...###
# #########O#O###O#O#####O#####O#O###O###O#####.#.#.#.###.#.###O###########.#.#######################O#####O#O#O#########O#######.###.#####.###
# #OOOOOOOOO#O#OOO#OOO#OOO#OOOOO#O#OOO#OOO#OOO#.#...#.###.#.#OOO#OOOOO#...#.#.###...###...#OOOOOOOOOOO#...#OOO#OOOOOOO#OOO#...###...#.#...#...#
# #O#########O#O#####O#O###O#####O#O###O###O#O#.#####.###.#.#O###O###O#.#.#.#.###.#.###.#.#O###########.#.###########O#O###.#.#####.#.#.#.###.#
# #OOOOOOO###O#OOOOO#O#O#OOO#OOOOO#OOO#OOOOO#O#.#.....#...#.#OOOOO#OOO#.#.#.#.#...#.#...#.>O>.#...#...#.#.###...###OOO#OOO#.#.......#...#.#...#
# #######O###O#####O#O#O#O###O#######O#######O#.#.#####.###.#######O###.#.#.#.#.###.#.#####O#.#.#.#.#.#.#.###.#.###O#####O#.#############.#.###
# #OOOOOOO#OOO#OOOOO#O#O#OOO#O#...###OOO#OOOOO#.#.#...#.#...#...###O###.#.#.#...###...#OOO#O#.#.#.#.#.#.#.#...#...>OOO#OOO#.............#.#.###
# #O#######O###O#####O#O###O#O#.#.#####O#O#####.#.#.#.#.#.###.#.###O###.#.#.###########O#O#O#.#.#.#.#.#.#.#.#######v#O#O###############.#.#.###
# #OOOOOOO#OOOOO#####O#O###OOO#.#.#...#OOO>...#.#.#.#.#.#.#...#...>O>.#.#...###OOO###OOO#OOO#...#.#.#...#...#...#...#O#OOO#.............#...###
# #######O###########O#O#######.#.#.#.###v###.#.#.#.#.#.#.#.#######O#.#.#######O#O###O###########.#.#########.#.#.###O###O#.###################
# #OOOOO#OOOOOOOOO#OOO#O#...#...#.#.#.#...###.#.#.#.#...#...###OOOOO#...#OOOOOOO#OOOOO#OOOOOOOOO#...#.........#...###O#OOO#.#.....#...#.......#
# #O###O#########O#O###O#.#.#.###.#.#.#.#####.#.#.#.###########O#########O#############O#######O#####.###############O#O###.#.###.#.#.#.#####.#
# #OOO#OOOOOOOOOOO#OOOOO#.#.#...#.#.#.#.....#.#.#.#.###OOO#OOO#OOOOOOOOO#O#OOO#OOOOOOOOO#OOOOOOO#OOO#.#.......#...###OOO###...###...#...#.....#
# ###O###################.#.###.#.#.#.#####.#.#.#.#.###O#O#O#O#########O#O#O#O#O#########O#######O#O#.#.#####.#.#.#######################.#####
# ###OOOOOOOOO#OOO#OOO###.#.....#.#.#.......#...#.#.#OOO#OOO#O###OOO#OOO#O#O#O#O#OOOOOOO#O#OOO#OOO#O#...#.....#.#.#OOO#OOO###...#.........#####
# ###########O#O#O#O#O###.#######.#.#############.#.#O#######O###O#O#O###O#O#O#O#O#####O#O#O#O#O###O#####.#####.#.#O#O#O#O###.#.#.#############
# #OOOOO#OOOOO#O#OOO#OOO#...#...#.#...........###...#OOOOOOO#OOO#O#O#OOO#OOO#O#O#OOOOO#OOO#O#O#O#OOO#OOO#.......#.#O#OOO#O#...#.#.............#
# #O###O#O#####O#######O###.#.#.#.###########.#############O###O#O#O###O#####O#O#####O#####O#O#O#O###O#O#########.#O#####O#.###.#############.#
# #OOO#OOO#OOO#OOO#OOOOO#...#.#.#...#.......#...#OOOOOOOOOOO###O#O#OOOOO#...#O#O#OOOOO#OOO#O#O#O#O###O#O#OOO#.....#O#OOOOO#...#...........#...#
# ###O#####O#O###O#O#####.###.#.###.#.#####.###.#O#############O#O#######.#.#O#O#O#####O#O#O#O#O#O###O#O#O#O#v#####O#O#######.###########.#.###
# #OOO#OOO#O#OOO#O#O#OOO#.....#...#.#.#...#.....#OOOOOOO#OOOOO#OOO###...#.#.#OOO#OOOOO#O#OOO#O#O#OOO#O#O#O#OOOOO#OOO#O#OOOOO#...........#...###
# #O###O#O#O###O#O#O#O#O#########.#.#.#.#.#############O#O###O#######.#.#.#.#########O#O#####O#O###O#O#O#O#####O#O###O#O###O###########.#######
# #OOO#O#OOO#OOO#O#O#O#O#.........#...#.#...#OOO#OOOOO#OOO#OOO#.....#.#...#...#...#OOO#O###OOO#OOO#O#O#OOO###OOO#O#OOO#O#OOO###.........#OOO###
# ###O#O#####O###O#O#O#O#.#############.###.#O#O#O###O#####O###.###.#.#######.#.#.#O###O###O#####O#O#O#######O###O#O###O#O#####.#########O#O###
# ###O#OOO###OOOOO#OOO#O#.#.....###...#.#...#O#O#OOO#O#OOOOO###...#.#...#.....#.#.#OOO#OOO#OOO#OOO#O#OOOOOOO#OOO#O#OOO#O#O#OOO#.........#O#O###
# ###O###O#############O#.#.###.###.#.#.#.###O#O###O#O#O#########.#.###.#.#####.#.###O###O###O#O###O#######O###O#O###O#O#O#O#O#########.#O#O###
# ###OOO#OOO#OOOOOOOOOOO#...###.....#...#.#OOO#O###O#O#OOOOOOO###.#.#...#.#...#.#.#.>OOO#O#OOO#OOO#O#OOOOO#OOO#OOO###O#O#O#O#O###.......#O#O###
# #####O###O#O###########################.#O###O###O#O#######O###.#.#.###.#.#.#.#.#.###O#O#O#####O#O#O###O###O#######O#O#O#O#O###.#######O#O###
# #####OOOOO#OOOOOOOOOOO#OOO###...........#OOO#O#OOO#O#OOOOOOO#...#.#.###.#.#...#.#...#O#O#OOOOO#O#OOO###OOO#O#OOOOOOO#O#OOO#OOO#...#OOO#O#OOO#
# #####################O#O#O###v#############O#O#O###O#O#######.###.#.###.#.#####.###.#O#O#####O#O#########O#O#O#######O#######O###.#O#O#O###O#
# #OOOOOOOOOOOOOOOOOOOOO#O#O#OOOOO###OOO#OOO#O#O#O#OOO#OOOOO#...#...#...#.#.#.....#...#O#O#OOOOO#OOO#OOOOO#OOO#OOOOOOO#O###OOOOO#...#O#O#O#OOO#
# #O#####################O#O#O###O###O#O#O#O#O#O#O#O#######O#.###.#####.#.#.#.#####.###O#O#O#######O#O###O###########O#O###O#####v###O#O#O#O###
# #OOO#OOOOO#OOOOOOOOOOO#O#O#O#OOO#OOO#O#O#O#O#O#O#O#OOOOOOO>.#...#...#.#.#.#.....#.###O#O#OOOOOOO#OOO#OOO#OOOOOOOOOOO#OOO#OOOOOOO#OOO#O#O#O###
# ###O#O###O#O#########O#O#O#O#O###O###O#O#O#O#O#O#O#O#########.###.#.#.#.#.#####.#.###O#O#######O#####O###O#############O#######O#O###O#O#O###
# #OOO#O#OOO#O#OOOOOOOOO#O#O#O#O#OOO###O#O#O#O#O#O#O#OOOOOOOOO#...#.#.#.#.#.#.....#...#O#O#OOOOOOO#OOOOO###OOO#OOOOO#OOO#O#OOOOOOO#OOO#O#O#O###
# #O###O#O###O#O#########O#O#O#O#O#####O#O#O#O#O#O#O#########O###.#.#.#.#.#.#.#######.#O#O#O#######O#########O#O###O#O#O#O#O#########O#O#O#O###
# #OOOOO#OOOOO#OOOOOOOOOOO#OOO#OOO#####OOO#OOO#OOO#OOOOOOOOOOO###...#...#...#.........#OOO#OOOOOOOOO#########OOO###OOO#OOO#OOOOOOOOOOO#OOO#OOO#
# ###########################################################################################################################################O#
