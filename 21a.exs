input = """
...................................................................................................................................
..#....#..............#.................#......#...................................##...............#.......#....#..#...#..........
.............#.#.........#....#...#...............#........#.............................##..#...#......#.............#.........#..
...................................#.#......#....#......##....................##...#.#.#....#......#....#.........#.........#.#.#..
........#..........................................................................................#.....##......#......#.......#..
..#...........#......#.............#.........................................#.....#...............#..#.....#.............#....#...
..#................#..................................#...................................##...............#........#.........#....
...................#....#........#..#....#...........#..........................................#.#................#...........#...
.#......#............#.....##.#...#.............................................#..#......#......#..#..............................
........................#...#..#.......#..#..................#.................#............#..#........#......#...#.....#.#.......
..............#...#................#..#............#........#...................#.....................#....#.......................
........#.#........#...#.#...#...#..#..#..#.#.............#..#................................#..........................#.........
..............#..#..#........#.......#..##...#...........#.....#..................#.....#.................#........#.....#...#.....
..#...........##...........#.......................................#.#..................#..#.................................#.....
.......................#.#...........#.....#...........#.......#.......#.#............##..#..#......................#..............
..#.........#.......#........#.#.#.#.#...#................#.......#...#................#...#...................#............#......
.#.....#........#..............#....#..............................#.#....#..............#....#.................#....#..#..........
................#..#..#.......................................#.#..........#.#.......................#.#.......#...#.............#.
.#...#......#....#.........................#...................##.....#......................#.........#........#.#.#....#...#.....
..#.....................##..........#........................#.................................#..#..........###................##.
.................#....#........#...#..#......................................#..................#.#....#.#.....#...##.##...##..#...
........#....##..#.................................................#..#......................#............#.......#.#......##..#...
.................#....................#...............#...#...#...#....#......#..............##..........#........#...........#....
.......##......#..................##..#........##.....#.#..#................#................#......#......#.#...............#.....
..............#...............................#.........#..............................................#.....#......#......#.#.#...
.#......#...........................#.........#..#...........#.....#..#.#..#............................................#..#.......
.#.....#...##..............#.#..#.................#...##..#.......#...................#........#.......#..................###......
.#...#.....................#.........................#....#.........#.......#...........................#.......#....##.#..#.......
....#.....................#......................#........................#.................................#....#.....#...##..##..
...#...#.........#............#..............##...#...............#......................#.........#...............#...........#...
........................#........................#.......#....#.............#....#......##................#.......#..#.......###...
.......#.........#.#....................#...................#.....##.........#.......................#....#....#......###..........
...................#...#.....#..................##......#................##...#......................#.#........#..................
...#.....#.....#.#...#..#...........#.....##.........#......#....................#...........................#.....................
..#........#....#.......#........................#............##.............#.....#....................#...#........#.............
............#..........#.................#.###..........................##.....#..#....#...#..#..............#.##..................
.#............#......#............#..................................###.................#.#.......................................
.#.#..#.......#.#..#............................#...................................................................#....#.....#...
................##.#................................................#..........................................#...#...............
.#.....#.##........#..........................#.#..............#......#...........#.......#.......#..........#.#...##........#.....
................#..#................#..................#..##........#..................#......................#..............#...#.
........#.....#....#............#........#...#............#.#.#.....#...........#.#....#...........................................
.#........#.......#..........................................##....#.#.............#.............#....#............#.............#.
.#....#........#......................#...........#....#.............................................#...............#......#......
................#............#.......#.............#............#.............#.....##...............#..................#...#......
.#..#....#..#.#.........#...#...........#.......................#..............#....#............#....#..#.................#.......
....#..........................#.....#......#..................##..............#.........##..#............................#........
....#.....................................#..#..............#..#........................................#..........................
.....#...............#...........#..#.........#........#.....#...................................#...................#.............
.........#...................#....#........#........................................#.........#..#.#....................#.....#....
....................#...................................#....#...................#.......#............#......#.....................
......................#.................#..#...###.....#..#.......#..#...#..........#....#...#..#....#......................#......
..................#.##.................#....#...#...........##....................#....#.............#.......#..................#..
.......#........#.....#..#.....................#.....................#...........#..........#.......#.............#..........#.....
.##................###.........##........###.........#.#....#..............#..#..............#..............................#......
....#..............##..........#.............#....#................................#.............#............#.#...........#......
...................#.#.......#.....#...#...............#..........#......#.#........#....#.......#.................................
........................#............................#.#...........#..........#................#......#...#.#.................#....
...#..........................................#...#.................................#...................#...#........#...........#.
..............#................#...#.......#....................#...#..............#........#....##.#.......#......................
................#..#.#.......#.#........#.........#...#......#....................................#..............#..#............#.
........#..#........#.##..##..................#...#.......................#.#..........................#................##.........
..............................#.....#...#................#.............#.............#...#..........................#..............
.......#.....#.........#............##...............#..........................#......#.#..#.......#....#..#.......#..#...........
...........................#................#........#..............#....#............#..................................#..#......
.................................................................S.................................................................
.....#........#..##..........#..#...#..........#.#...........#.#....#..........##........#..........#..#.......#..#................
.......#......#......#...#...........#.##......#...#......#..........................#.......#.....................................
...........................#.............#......#..........#.#.....#..................##..........#...................#............
........#.............##......#...#......................##...#........#..........................#............#...................
......................#...#....#..#.##...#..#....#............##........................#..............#..#........#..##...........
...............................................#......#...........................#...#............#.....#........#................
............#..........#.....#.....#........#...........#................#......#...####......#.........#.......................#..
.............#........#..#.#..........#.##...#.#..#....#..........................#...#..#...###...................#............#..
..............#..#...........#.............#.#...#......................#..........................................................
..............#..........#..#.......#.........................#.#......#...#..................#..#......#..........................
................#.........#...........#............#........#.#.#....................................#.............................
........................#...#..#..#....#...................#...........#..................##.....#..............#................#.
.#......##...........#...#.............##........#..........#..........#...#...#.#......#.#....#...##........##....................
.......................##...#......#......#....#.............#.....#..............#.....................#.....#.........#...#..#.#.
.................................#..#....#....##...................#......#...#..............................##....................
...#......##..........#.............#.#....#................#...#............#.........#..#................###...........#..#......
.#..........#.........#....##.#....#......##.#....#.#...........#...##........#............#....#.#...#.#.....................#....
..#........#.................#.#...........................#...............#........#.....#.#...............#........#.#...........
..#...........#..........#....#..#............................#........#............................#..#..................##.......
...........##..............................#..##.......................##...#....................#.................................
...........................#......##...#.....#..............#...#....#................#...#.....##...............#......#..........
.......#..#...#................#...#...........#........#.#.#..................#..............#...#.....................##.........
.................#.#.....................#.#.............#..............................#......#.......#.......#......##.....#.....
............#.......#..............#........#..#......#..#................................#...#.....#.#..........#......#......#...
...................#...............................................#..............#........#.#..................##..............##.
...#..............................#.........#................#................#.#...#.......#.....#.........#......................
.#.#.#...............#...................##......#......................#............#........................#.......#........#...
......#.....#....#......#..........#...#...##.............#.#..............................#.#..#...........#......##..............
....................#...#........#..#..#....#................................#.......#..#..##..................#.........#.........
.......#...#.........#..............#................#...#.........#......................................#..........#...#.#.....#.
..##..#.....................................#.....#........#....#.....#....................................#..........#.........##.
.#.........................................##....#.........................#..#.........#.............#.......###..................
...........#...##..................................##..#....#.......#....#..#.......#......................#......#.#.#...#........
...........#...#.......................#....#..##..................#............#.#...##....#.......................###............
..........#......##........................#........#.......#......#................................#..............................
...................##....#..#................#........................#...#....#....#....#........#..........#.....#....#..........
.......................#.....#...................#...#...#..#.............#.#..................................#..#...#..........#.
.................#.....................................................#.#.........................#........................#......
................#..........#.........................#.##.##...........#.................................#.........#..#............
....##....##......##.....#....................#......#..........#..........................................#...#..........##.......
...#..........#..........#..........#............##...#...#.#...................#...#.............#.......#....................#...
.....#........#.........#............................#..#.#............#.....#...............#..........#...#..................#...
...............#...#.#...#.......#........................#........................................#......#..............#.........
.....#.#............#.....#.....................................#....#...##.................................#....#..#..#.....#.#...
....#...#..#.....#...................#..#...................#.....#...#......#.....................#.....#....#.#.....##..##.......
.........................#........................#....#..#.#......#.....#.................................#.........#...#.........
.....#.............#......................#.........#......................................#........................#..#.#.#.....#.
.........#.#.......................#.#..#...........#.##......#.............#......................................#.....#....###..
.............#...................#...#.................#.#......#....#.....#.#..........#.....#....#...#.#......#...#...##....#..#.
......##......#.................#..#....................#....#..#.......#...................##......#.......#....#...#...#.#.......
..#....#........##.......##.#...#...........................#.......................#.....#...#.......##..................#........
.....#...........#.#...............#.#......#..#..........#..#....................................##......#..........#...#..#...#..
.#....................##...#.............................##.....#.................#........###...........#...#..................#..
.....#..#....#...#....#........#..#..#.....#....................................#......#....#.##.........#.....................#...
.......#............#................#......#.#....................#...#.................#.............#.......##.#................
..#.....#..............#........................#............#........#..........#..............#..##.....#.#........##......#..#..
..........#.............#................#...................#..............................#......#...............................
....#....................#.#....#................#.##.......................#......................#.....................#....#....
..#...#................##..#.........#.............#..#.........#............................#.......#........#...#.......#....##..
....#..#.................#....#................................................#...........#.......#...........#..............#....
...#...#................#...........#........#..#...#....................#........#.....##...........#.#...........##.....#.....##.
...........#.....#..#........#.....#..........#.#......#.#........................................#...#.....................#......
............................#........##..........#......................................................#........#....#.#...#.#....
..#..#.........#.#..........#.........#.........#............................#..#....#......##..#......#..............#............
...................................................................................................................................\
"""

matrix = String.split(input, "\n") |> Enum.map(&String.split(&1, "", trim: true))

start_xy =
  Enum.with_index(matrix)
  |> Enum.find_value(fn {row, i} ->
    j = row |> Enum.find_index(&(&1 == "S"))
    if j != nil, do: {i, j}, else: nil
  end)

defmodule BFSCrawler do
  def crawl(_matrix, _max_steps, queue, visited) when length(queue) == 0 do
    visited
  end

  # steps = steps so far
  # queue = {x, y, steps}
  # visited = set of [{x, y}]
  def crawl(matrix, max_steps, queue, visited) do
    height = length(matrix)
    width = length(Enum.at(matrix, 0))
    [curr | rest] = queue
    {curr_x, curr_y, steps} = curr

    if {curr_x, curr_y} in visited do
      crawl(matrix, max_steps, rest, visited)
    else
      next_xysteps =
        for {i, j} <- [{-1, 0}, {0, 1}, {1, 0}, {0, -1}] do
          next_x = curr_x + i
          next_y = curr_y + j

          cond do
            next_x < 0 || next_x >= height || next_y < 0 || next_y >= width ->
              nil

            matrix |> Enum.at(next_x) |> Enum.at(next_y) == "#" ->
              nil

            {next_x, next_y} in visited ->
              nil

            steps + 1 > max_steps ->
              nil

            true ->
              {next_x, next_y, steps + 1}
          end
        end
        |> Enum.filter(& &1)

      next_visited = [{curr_x, curr_y} | visited]
      crawl(matrix, max_steps, rest ++ next_xysteps, next_visited)
    end
  end
end

max_steps = 64
{start_x, start_y} = start_xy

reachable_xys =
  BFSCrawler.crawl(matrix, max_steps, [{start_x, start_y, 0}], [])
  |> Enum.filter(fn {x, y} ->
    rem(abs(x - start_x) + abs(y - start_y), 2) == rem(max_steps, 2)
  end)

ans = length(reachable_xys)

dbg(ans)
# 3858

# viz =
#   for {row, i} <- Enum.with_index(matrix) do
#     for {cell, j} <- Enum.with_index(row) do
#       if cell == "." && {i, j} in reachable_xys, do: "O", else: cell
#     end
#     |> Enum.join("")
#   end
#   |> Enum.join("\n")

# IO.puts(viz)

# ...................................................................................................................................
# ..#....#..............#.................#......#.................O.................##...............#.......#....#..#...#..........
# .............#.#.........#....#...#...............#........#....O.O......................##..#...#......#.............#.........#..
# ...................................#.#......#....#......##.....O.O.O..........##...#.#.#....#......#....#.........#.........#.#.#..
# ........#.....................................................O.O.O.O..............................#.....##......#......#.......#..
# ..#...........#......#.............#.........................O.O.O.O.O.......#.....#...............#..#.....#.............#....#...
# ..#................#..................................#.....O.O.O.O.O.O...................##...............#........#.........#....
# ...................#....#........#..#....#...........#.....O.O.O.O.O.O.O........................#.#................#...........#...
# .#......#............#.....##.#...#.......................O.O.O.O.O.O.O.O.......#..#......#......#..#..............................
# ........................#...#..#.......#..#..............O.O.#.O.O.O.O.O.O.....#............#..#........#......#...#.....#.#.......
# ..............#...#................#..#............#....O.O.#.O.O.O.O.O.O.O.....#.....................#....#.......................
# ........#.#........#...#.#...#...#..#..#..#.#..........O.O#O.#.O.O.O.O.O.O.O..................#..........................#.........
# ..............#..#..#........#.......#..##...#........O.O#O.O.O#O.O.O.O.O.O.O.....#.....#.................#........#.....#...#.....
# ..#...........##...........#.........................O.O.O.O.O.O.O.#.#.O.O.O.O..........#..#.................................#.....
# .......................#.#...........#.....#........O.O#O.O.O.O#O.O.O.O#O#O.O.O.......##..#..#......................#..............
# ..#.........#.......#........#.#.#.#.#...#.........O.O.O.O#O.O.O.O#O.O#O.O.O.O.O.......#...#...................#............#......
# .#.....#........#..............#....#.............O.O.O.O.O.O.O.O.O#O#O.O.#.O.O.O........#....#.................#....#..#..........
# ................#..#..#..........................O.O.O.O.O.O.O#O#O.O.O.O.O.#.#.O.O...................#.#.......#...#.............#.
# .#...#......#....#.........................#....O.O.O.O.O.O.O.O##.O.O.#.O.O.O.O.O.O..........#.........#........#.#.#....#...#.....
# ..#.....................##..........#..........O.O.O.O.O.O.O.#.O.O.O.O.O.O.O.O.O.O.O...........#..#..........###................##.
# .................#....#........#...#..#.......O.O.O.O.O.O.O.O.O.O.O.O.O.O.O.O#O.O.O.O...........#.#....#.#.....#...##.##...##..#...
# ........#....##..#...........................O.O.O.O.O.O.O.O.O.O.O.#.O#O.O.O.O.O.O.O.O.......#............#.......#.#......##..#...
# .................#....................#.....O.O.O.O.O.#.O.#.O.#.O.#.O.O#O.O.O.#.O.O.O.O......##..........#........#...........#....
# .......##......#..................##..#....O.O.##O.O.O#O#O.#.O.O.O.O.O.O.O.O#O.O.O.O.O.O.....#......#......#.#...............#.....
# ..............#...........................O.O.#.O.O.O.O.#.O.O.O.O.O.O.O.O.O.O.O.O.O.O.O.O..............#.....#......#......#.#.#...
# .#......#...........................#....O.O.O#O.#.O.O.O.O.O.#.O.O.#.O#O#O.#.O.O.O.O.O.O.O..............................#..#.......
# .#.....#...##..............#.#..#.......O.O.O.O.O.#.O.##O.#.O.O.O.#.O.O.O.O.O.O.O.O.O.#.O.O....#.......#..................###......
# .#...#.....................#...........O.O.O.O.O.O.O.#.O.O#O.O.O.O.O#O.O.O.O#O.O.O.O.O.O.O.O............#.......#....##.#..#.......
# ....#.....................#...........O.O.O.O.O.O#O.O.O.O.O.O.O.O.O.O.O.O.#.O.O.O.O.O.O.O.O.O...............#....#.....#...##..##..
# ...#...#.........#............#......O.O.O.O.##O.O#O.O.O.O.O.O.O.O#O.O.O.O.O.O.O.O.O.O.O.#.O.O.....#...............#...........#...
# ........................#...........O.O.O.O.O.O.O#O.O.O.O#O.O.#.O.O.O.O.O.O.#.O.O#O.O.O.##O.O.O...........#.......#..#.......###...
# .......#.........#.#...............O.O.O#O.O.O.O.O.O.O.O.O.O#O.O.O##.O.O.O.O.#.O.O.O.O.O.O.O.O.O.....#....#....#......###..........
# ...................#...#.....#....O.O.O.O.O.O.O.##O.O.O.#.O.O.O.O.O.O.O.O##.O.#.O.O.O.O.O.O.O.O.O....#.#........#..................
# ...#.....#.....#.#...#..#........O.O#O.O.O##.O.O.O.O.#.O.O.O#O.O.O.O.O.O.O.O.O.O.#.O.O.O.O.O.O.O.O...........#.....................
# ..#........#....#.......#.......O.O.O.O.O.O.O.O.O#O.O.O.O.O.O.##O.O.O.O.O.O.O#O.O.O#O.O.O.O.O.O.O.O.....#...#........#.............
# ............#..........#.......O.O.O.O.O.#.###.O.O.O.O.O.O.O.O.O.O.O.O.O##.O.O.#.O#O.O.#.O.#.O#O.O.O.........#.##..................
# .#............#......#........O.O.#.O.O.O.O.O.O.O.O.O.O.O.O.O.O.O.O.O###O.O.O.O.O.O.O.O.O#O#O.O.O.O.O..............................
# .#.#..#.......#.#..#.........O.O.O.O.O.O.O.O.O.O#O.O.O.O.O.O.O.O.O.O.O.O.O.O.O.O.O.O.O.O.O.O.O.O.O.O.O..............#....#.....#...
# ................##.#........O.O.O.O.O.O.O.O.O.O.O.O.O.O.O.O.O.O.O.O.#.O.O.O.O.O.O.O.O.O.O.O.O.O.O.O.O.O........#...#...............
# .#.....#.##........#.......O.O.O.O.O.O.O.O.O.O#O#O.O.O.O.O.O.O.#.O.O.O#O.O.O.O.O.O#O.O.O.O#O.O.O.O#O.O.O.....#.#...##........#.....
# ................#..#......O.O.O.O.O.#.O.O.O.O.O.O.O.O.O#O.##O.O.O.O.#.O.O.O.O.O.O.O.O.O#O.O.O.O.O.O.O.O.O.....#..............#...#.
# ........#.....#....#.....O.O.O.O#O.O.O.O.#.O.#.O.O.O.O.O.O#O#O#O.O.O#O.O.O.O.O.O#O#O.O.#.O.O.O.O.O.O.O.O.O.........................
# .#........#.......#.....O.O.O.O.O.O.O.O.O.O.O.O.O.O.O.O.O.O.O##.O.O#O#O.O.O.O.O.O.O#O.O.O.O.O.O.O#O.O.#.O.O........#.............#.
# .#....#........#.......O.O.O.O.O.O.O.O#O.O.O.O.O.O#O.O.#.O.O.O.O.O.O.O.O.O.O.O.O.O.O.O.O.O.O.O.O.O.O.#.O.O.O.........#......#......
# ................#.....O.O.O.O#O.O.O.O#O.O.O.O.O.O.O#O.O.O.O.O.O.#.O.O.O.O.O.O.#.O.O.##O.O.O.O.O.O.O.O#O.O.O.O...........#...#......
# .#..#....#..#.#......O.O#O.O#O.O.O.O.O.O#O.O.O.O.O.O.O.O.O.O.O.O#O.O.O.O.O.O.O.#.O.O#O.O.O.O.O.O.#.O.O#O.#.O.O.............#.......
# ....#...............O.O.O.O.O.O#O.O.O#O.O.O.#.O.O.O.O.O.O.O.O.O##.O.O.O.O.O.O.O#O.O.O.O.O##.O#O.O.O.O.O.O.O.O.O...........#........
# ....#..............O.O.O.O.O.O.O.O.O.O.O.O#O.#.O.O.O.O.O.O.O#O.#.O.O.O.O.O.O.O.O.O.O.O.O.O.O.O.O.O.O.O.O#O.O.O.O...................
# .....#............O.O#O.O.O.O.O.O#O.#.O.O.O.O.#.O.O.O.O#O.O.O#O.O.O.O.O.O.O.O.O.O.O.O.O.O.O.O.O.O#O.O.O.O.O.O.O.O....#.............
# .........#.......O.O.O.O.O.O.#.O.O#O.O.O.O.#.O.O.O.O.O.O.O.O.O.O.O.O.O.O.O.O.O.O.O.O#O.O.O.O.O#O.#.#.O.O.O.O.O.O.O......#.....#....
# ................O.O.#.O.O.O.O.O.O.O.O.O.O.O.O.O.O.O.O.O.#.O.O#O.O.O.O.O.O.O.O.O.O#O.O.O.O#O.O.O.O.O.O.#.O.O.O#O.O.O................
# ...............O.O.O.O#O.O.O.O.O.O.O.O.O#O.#.O.###.O.O.#.O#O.O.O.O#O.#.O.#.O.O.O.O.O#O.O.#.O.#.O#O.O.#.O.O.O.O.O.O.O........#......
# ..............O.O.#.##O.O.O.O.O.O.O.O.O#O.O.#.O.#.O.O.O.O.O.##O.O.O.O.O.O.O.O.O.O.#.O.O#O.O.O.O.O.O.O#O.O.O.O#O.O.O.O...........#..
# .......#.....O.O#O.O.O#O.#.O.O.O.O.O.O.O.O.O.O.#.O.O.O.O.O.O.O.O.O.O.#.O.O.O.O.O.#.O.O.O.O.O#O.O.O.O#O.O.O.O.O.O.O#O.O.......#.....
# .##.........O.O.O.O###O.O.O.O.O##.O.O.O.O###O.O.O.O.O#O#O.O.#.O.O.O.O.O.O.O#O.#.O.O.O.O.O.O.O#O.O.O.O.O.O.O.O.O.O.O.O.O.....#......
# ....#......O.O.O.O.##O.O.O.O.O.#.O.O.O.O.O.O.#.O.O#O.O.O.O.O.O.O.O.O.O.O.O.O.O.O.O.#.O.O.O.O.O.O.#.O.O.O.O.O.O#O#O.O.O.O....#......
# ..........O.O.O.O.O#O#O.O.O.O#O.O.O#O.O#O.O.O.O.O.O.O.O#O.O.O.O.O.#.O.O.O#O#O.O.O.O.#.O.O#O.O.O.O#O.O.O.O.O.O.O.O.O.O.O.O..........
# .........O.O.O.O.O.O.O.O#O.O.O.O.O.O.O.O.O.O.O.O.O.O.#.#.O.O.O.O.O.#.O.O.O.O.O#O.O.O.O.O.O.O.O.#.O.O.O#O.O#O#O.O.O.O.O.O.O....#....
# ...#....O.O.O.O.O.O.O.O.O.O.O.O.O.O.O.O.O.O.O.#.O.#.O.O.O.O.O.O.O.O.O.O.O.O.O.O.O.O.#.O.O.O.O.O.O.O.O.O.#.O.#.O.O.O.O#O.O.O......#.
# .......O.O.O.O#O.O.O.O.O.O.O.O.#.O.#.O.O.O.#.O.O.O.O.O.O.O.O.O.O#O.O#O.O.O.O.O.O.O.#.O.O.O.O#O.O.##O#O.O.O.O#O.O.O.O.O.O.O.O.......
# ......O.O.O.O.O.#.O#O#O.O.O.O#O#O.O.O.O.#.O.O.O.O.#.O.#.O.O.O#O.O.O.O.O.O.O.O.O.O.O.O.O.O.O.O.O.O.#.O.O.O.O.O.O.O#O.#.O.O.O.O....#.
# .....O.O#O.#.O.O.O.O#O##.O##.O.O.O.O.O.O.O.O.O#O.O#O.O.O.O.O.O.O.O.O.O.O.O#O#O.O.O.O.O.O.O.O.O.O.O.O.O.#.O.O.O.O.O.O.O.O##.O.O.....
# ....O.O.O.O.O.O.O.O.O.O.O.O.O.#.O.O.#.O.#.O.O.O.O.O.O.O.O#O.O.O.O.O.O.O#O.O.O.O.O.O.O#O.O#O.O.O.O.O.O.O.O.O.O.O.O.O.#.O.O.O.O.O....
# ...O.O.#.O.O.#.O.O.O.O.#.O.O.O.O.O.O##.O.O.O.O.O.O.O.#.O.O.O.O.O.O.O.O.O.O.O.O.O#O.O.O.#.#.O#O.O.O.O#O.O.#.O#O.O.O.O#O.#.O.O.O.O...
# ..O.O.O.O.O.O.O.O.O.O.O.O.O#O.O.O.O.O.O.O.O.#.O.O.O.O#O.O.O.O.O.O.O.#.O.O#O.O.O.O.O.O.#.O.O.O.O.O.O.O.O.O.O.O.O.O.O.O.O.O#O.#.O.O..
# .O.O.O.O.O.O.O.O.O.O.O.O.O.O.O.O.O.O.O.O.O.O.O.O.O.O.O.O.O.O.O.O.S.O.O.O.O.O.O.O.O.O.O.O.O.O.O.O.O.O.O.O.O.O.O.O.O.O.O.O.O.O.O.O.O.
# ..O.O#O.O.O.O.#.O##.O.O.O.O.O#O.#.O.#.O.O.O.O.O#O#O.O.O.O.O.O#O#O.O.#.O.O.O.O.O##.O.O.O.O#O.O.O.O.O.#.O#O.O.O.O#O.#.O.O.O.O.O.O.O..
# ...O.O.#.O.O.O#O.O.O.#.O.#.O.O.O.O.O.#.##O.O.O.#.O.#.O.O.O#O.O.O.O.O.O.O.O.O.O.O.O.O.#.O.O.O.#.O.O.O.O.O.O.O.O.O.O.O.O.O.O.O.O.O...
# ....O.O.O.O.O.O.O.O.O.O.O.O#O.O.O.O.O.O.O#O.O.O.#.O.O.O.O.O#O#O.O.O#O.O.O.O.O.O.O.O.O.##O.O.O.O.O.#.O.O.O.O.O.O.O.O.O.#.O.O.O.O....
# .....O.O#O.O.O.O.O.O.O##.O.O.O#O.O#O.O.O.O.O.O.O.O.O.O.O.##O.O#O.O.O.O.#.O.O.O.O.O.O.O.O.O.O.O.O.O#O.O.O.O.O.O.#.O.O.O.O.O.O.O.....
# ......O.O.O.O.O.O.O.O.#.O.#.O.O#O.#.##O.O#O.#.O.O#O.O.O.O.O.O.##O.O.O.O.O.O.O.O.O.O.O.O.#.O.O.O.O.O.O.O#O.#.O.O.O.O#O.##O.O.O......
# .......O.O.O.O.O.O.O.O.O.O.O.O.O.O.O.O.O.O.O.O.#.O.O.O#O.O.O.O.O.O.O.O.O.O.O.O.O.O#O.O#O.O.O.O.O.O.#.O.O.#.O.O.O.O#O.O.O.O.O.......
# ........O.O.#.O.O.O.O.O#O.O.O#O.O.O#O.O.O.O.#.O.O.O.O.O.#.O.O.O.O.O.O.O.O#O.O.O.#.O.####O.O.O.#.O.O.O.O.#.O.O.O.O.O.O.O.O.O.....#..
# .........O.O.#.O.O.O.O#O.#.#.O.O.O.O.O#O##.O.#.#.O#O.O.#.O.O.O.O.O.O.O.O.O.O.O.O.O#O.O#O.#.O.###.O.O.O.O.O.O.O.O.O.#.O.O.O......#..
# ..........O.O.#.O#O.O.O.O.O.O#O.O.O.O.O.O.O#O#O.O#O.O.O.O.O.O.O.O.O.O.O.#.O.O.O.O.O.O.O.O.O.O.O.O.O.O.O.O.O.O.O.O.O.O.O.O..........
# ...........O.O#O.O.O.O.O.#.O#O.O.O.O#O.O.O.O.O.O.O.O.O.O.O.O.O#O#O.O.O.#.O.#.O.O.O.O.O.O.O.O.O#O.#.O.O.O#O.O.O.O.O.O.O.O...........
# ............O.O.#.O.O.O.O.#.O.O.O.O.O.#.O.O.O.O.O.O#O.O.O.O.#.#.#.O.O.O.O.O.O.O.O.O.O.O.O.O.O.O.O.O.O#O.O.O.O.O.O.O.O.O............
# .............O.O.O.O.O.O#O.O#O.#.O#O.O.#.O.O.O.O.O.O.O.O.O.#.O.O.O.O.O.#.O.O.O.O.O.O.O.O.O##.O.O.#.O.O.O.O.O.O.O#O.O.O...........#.
# .#......##....O.O.O.O#O.O#O.O.O.O.O.O.O##.O.O.O.O#O.O.O.O.O.#.O.O.O.O.O#O.O#O.O#O#O.O.O.#.#.O.O#O.O##.O.O.O.O##.O.O.O..............
# ...............O.O.O.O.##O.O#O.O.O.#.O.O.O#O.O.#.O.O.O.O.O.O.#.O.O.#.O.O.O.O.O.O.O#O.O.O.O.O.O.O.O.O.O.O#O.O.O#O.O.O....#...#..#.#.
# ................O.O.O.O.O.O.O.O.O#O.#.O.O#O.O.##O.O.O.O.O.O.O.O.O.O#O.O.O.#.O.#.O.O.O.O.O.O.O.O.O.O.O.O.O.O.O##.O.O................
# ...#......##.....O.O.O#O.O.O.O.O.O.O#O#O.O.#.O.O.O.O.O.O.O.O#O.O#O.O.O.O.O.O.#.O.O.O.O.#.O#O.O.O.O.O.O.O.O.###.O.O.......#..#......
# .#..........#.....O.O.#.O.O##.#.O.O#O.O.O.##O#O.O.#.#.O.O.O.O.O.#.O.##O.O.O.O.#.O.O.O.O.O.O#O.O.#.#.O.#.#.O.O.O.O.............#....
# ..#........#.......O.O.O.O.O.#.#.O.O.O.O.O.O.O.O.O.O.O.O.O.#.O.O.O.O.O.O.O.#.O.O.O.O#O.O.O#O#O.O.O.O.O.O.O.O#O.O.....#.#...........
# ..#...........#.....O.O.O#O.O.#.O#O.O.O.O.O.O.O.O.O.O.O.O.O.O.#.O.O.O.O#O.O.O.O.O.O.O.O.O.O.O.O.O.O.#.O#O.O.O.O...........##.......
# ...........##........O.O.O.O.O.O.O.O.O.O.O.#.O##.O.O.O.O.O.O.O.O.O.O.O.##O.O#O.O.O.O.O.O.O.O.O.O.#.O.O.O.O.O.O.....................
# ......................O.O.O#O.O.O.##O.O#O.O.O#O.O.O.O.O.O.O.#.O.#.O.O#O.O.O.O.O.O.O.O.#.O.#.O.O.##O.O.O.O.O.O....#......#..........
# .......#..#...#........O.O.O.O.#.O.#.O.O.O.O.O.#.O.O.O.O#O#O#O.O.O.O.O.O.O.O.O.#.O.O.O.O.O.O.O#O.O#O.O.O.O.O............##.........
# .................#.#....O.O.O.O.O.O.O.O.O#O#O.O.O.O.O.O.O#O.O.O.O.O.O.O.O.O.O.O.O.O.O.O.#.O.O.O#O.O.O.O#O.O....#......##.....#.....
# ............#.......#....O.O.O.O.O.#.O.O.O.O#O.#.O.O.O#O.#.O.O.O.O.O.O.O.O.O.O.O.O.O.O.O.O#O.O#O.O.O#O#O.O.......#......#......#...
# ...................#......O.O.O.O.O.O.O.O.O.O.O.O.O.O.O.O.O.O.O.O.O#O.O.O.O.O.O.O.#.O.O.O.O#O#O.O.O.O.O.O.......##..............##.
# ...#.......................O.O.O.O#O.O.O.O.O#O.O.O.O.O.O.O.O.#.O.O.O.O.O.O.O.O#O#O.O#O.O.O.O#O.O.O#O.O.O....#......................
# .#.#.#...............#......O.O.O.O.O.O.O##.O.O.O#O.O.O.O.O.O.O.O.O.O.O.#.O.O.O.O.O.O#O.O.O.O.O.O.O.O.O.......#.......#........#...
# ......#.....#....#......#....O.O.O.#.O.#.O.##O.O.O.O.O.O.O#O#O.O.O.O.O.O.O.O.O.O.O.O.O.O.O.#.#.O#O.O.O......#......##..............
# ....................#...#.....O.O#O.#.O#O.O.#.O.O.O.O.O.O.O.O.O.O.O.O.O.O.O.O#O.O.O.O#O.#.O##.O.O.O.O..........#.........#.........
# .......#...#.........#.........O.O.O#O.O.O.O.O.O.O.O.#.O.#.O.O.O.O.#.O.O.O.O.O.O.O.O.O.O.O.O.O.O.O.O......#..........#...#.#.....#.
# ..##..#.........................O.O.O.O.O.O.#.O.O.#.O.O.O.O#O.O.#.O.O.#.O.O.O.O.O.O.O.O.O.O.O.O.O.O........#..........#.........##.
# .#...............................O.O.O.O.O.##O.O.#.O.O.O.O.O.O.O.O.O.O.O.O.#.O#O.O.O.O.O#O.O.O.O.O....#.......###..................
# ...........#...##.................O.O.O.O.O.O.O.O.O##.O#O.O.#.O.O.O.#.O.O#O.#.O.O.O.#.O.O.O.O.O.O..........#......#.#.#...#........
# ...........#...#...................O.O.#.O.O#O.##O.O.O.O.O.O.O.O.O.#.O.O.O.O.O.O#O#O.O##.O.O#O.O....................###............
# ..........#......##.................O.O.O.O#O.O.O.O.#.O.O.O.#.O.O.O#O.O.O.O.O.O.O.O.O.O.O.O.O.O.....#..............................
# ...................##....#..#........O.O.O.O.#.O.O.O.O.O.O.O.O.O.O.O.O#O.O#O.O.#.O.O#O.O.#.O.O....#..........#.....#....#..........
# .......................#.....#........O.O.O.O.O.O#O.O#O.O#O.#.O.O.O.O.O.O.#.#.O.O.O.O.O.O.O.O..................#..#...#..........#.
# .................#.....................O.O.O.O.O.O.O.O.O.O.O.O.O.O.O.O.#.#.O.O.O.O.O.O.O.O.O.......#........................#......
# ................#..........#............O.O.O.O.O.O.O#O##.##O.O.O.O.O.O#O.O.O.O.O.O.O.O.O.O..............#.........#..#............
# ....##....##......##.....#...............O.O.O#O.O.O.#.O.O.O.O.O#O.O.O.O.O.O.O.O.O.O.O.O.O.................#...#..........##.......
# ...#..........#..........#..........#.....O.O.O.O##.O.#.O.#.#.O.O.O.O.O.O.O.O.O.#.O.#.O.O.........#.......#....................#...
# .....#........#.........#..................O.O.O.O.O.#.O#O#O.O.O.O.O.O.#.O.O.#.O.O.O.O.O.....#..........#...#..................#...
# ...............#...#.#...#.......#..........O.O.O.O.O.O.O.#.O.O.O.O.O.O.O.O.O.O.O.O.O.O............#......#..............#.........
# .....#.#............#.....#..................O.O.O.O.O.O.O.O.O.O#O.O.#.O.##O.O.O.O.O.O......................#....#..#..#.....#.#...
# ....#...#..#.....#...................#..#.....O.O.O.O.O.O.O.#.O.O.#.O.#.O.O.O#O.O.O.O..............#.....#....#.#.....##..##.......
# .........................#.....................O.O#O.O.#.O#O#O.O.O.#.O.O.#.O.O.O.O.O.......................#.........#...#.........
# .....#.............#......................#.....O.O.#.O.O.O.O.O.O.O.O.O.O.O.O.O.O.O........#........................#..#.#.#.....#.
# .........#.#.......................#.#..#........O.O#O##.O.O.O#O.O.O.O.O.O.O#O.O.O.................................#.....#....###..
# .............#...................#...#............O.O.O#O#O.O.O.#.O.O#O.O.O#O#O.O.......#.....#....#...#.#......#...#...##....#..#.
# ......##......#.................#..#...............O.O.O#O.O.#.O#O.O.O.O#O.O.O.O............##......#.......#....#...#...#.#.......
# ..#....#........##.......##.#...#...................O.O.O.O.#.O.O.O.O.O.O.O.O.O.....#.....#...#.......##..................#........
# .....#...........#.#...............#.#......#..#.....O.O.O#O.#.O.O.O.O.O.O.O.O....................##......#..........#...#..#...#..
# .#....................##...#..........................O.O##.O.O.#.O.O.O.O.O.O.....#........###...........#...#..................#..
# .....#..#....#...#....#........#..#..#.....#...........O.O.O.O.O.O.O.O.O.O.O....#......#....#.##.........#.....................#...
# .......#............#................#......#.#.........O.O.O.O.O.O#O.O#O.O..............#.............#.......##.#................
# ..#.....#..............#........................#........O.O.#.O.O.O.O#O.O.......#..............#..##.....#.#........##......#..#..
# ..........#.............#................#................O.O#O.O.O.O.O.O...................#......#...............................
# ....#....................#.#....#................#.##......O.O.O.O.O.O.O....#......................#.....................#....#....
# ..#...#................##..#.........#.............#..#.....O.O.#.O.O.O......................#.......#........#...#.......#....##..
# ....#..#.................#....#..............................O.O.O.O.O.........#...........#.......#...........#..............#....
# ...#...#................#...........#........#..#...#.........O.O.O.O....#........#.....##...........#.#...........##.....#.....##.
# ...........#.....#..#........#.....#..........#.#......#.#.....O.O.O..............................#...#.....................#......
# ............................#........##..........#..............O.O.....................................#........#....#.#...#.#....
# ..#..#.........#.#..........#.........#.........#................O...........#..#....#......##..#......#..............#............
# ...................................................................................................................................
